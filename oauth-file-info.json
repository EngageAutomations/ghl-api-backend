{
  "name": "index.js",
  "path": "index.js",
  "sha": "5f603275485c262ad6226e3f48b9b1780cd32d57",
  "size": 12402,
  "url": "https://api.github.com/repos/EngageAutomations/oauth-backend/contents/index.js?ref=main",
  "html_url": "https://github.com/EngageAutomations/oauth-backend/blob/main/index.js",
  "git_url": "https://api.github.com/repos/EngageAutomations/oauth-backend/git/blobs/5f603275485c262ad6226e3f48b9b1780cd32d57",
  "download_url": "https://raw.githubusercontent.com/EngageAutomations/oauth-backend/main/index.js",
  "type": "file",
  "content": "LyoqCiAqIFB1cmUgT0F1dGggQmFja2VuZCAtIENvcnJlY3QgQ3JlZGVudGlh\nbHMKICogVXNlcyB0aGUgY29ycmVjdCBHb0hpZ2hMZXZlbCBPQXV0aCBjcmVk\nZW50aWFscwogKi8KCmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNz\nJyk7CmNvbnN0IGNvcnMgPSByZXF1aXJlKCdjb3JzJyk7CmNvbnN0IGF4aW9z\nID0gcmVxdWlyZSgnYXhpb3MnKTsKCmNvbnN0IGFwcCA9IGV4cHJlc3MoKTsK\nY29uc3QgcG9ydCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwMDsKCi8vIE1p\nZGRsZXdhcmUKYXBwLnVzZShjb3JzKCkpOwphcHAudXNlKGV4cHJlc3MuanNv\nbigpKTsKCi8vIEluLW1lbW9yeSBPQXV0aCBpbnN0YWxsYXRpb24gc3RvcmUK\nY29uc3QgaW5zdGFsbGF0aW9ucyA9IG5ldyBNYXAoKTsKCi8vIEdvSGlnaExl\ndmVsIE9BdXRoIENvbmZpZ3VyYXRpb24gLSBDT1JSRUNUIENSRURFTlRJQUxT\nCmNvbnN0IENMSUVOVF9JRCA9ICc2ODQ3NDkyNGE1ODZiY2UyMmE2ZTY0Zjct\nbWJwa215dTQnOwpjb25zdCBDTElFTlRfU0VDUkVUID0gJ2I1YTdhMTIwLTdk\nZjctNGQyMy04Nzk2LTQ4NjNjYmQwOGY5NCc7CmNvbnN0IFJFRElSRUNUX1VS\nSSA9ICdodHRwczovL2Rpci5lbmdhZ2VhdXRvbWF0aW9ucy5jb20vYXBpL29h\ndXRoL2NhbGxiYWNrJzsKCi8vIEVuaGFuY2VkIE9BdXRoIENhbGxiYWNrIEhh\nbmRsZXIKYXBwLmdldCgnL2FwaS9vYXV0aC9jYWxsYmFjaycsIGFzeW5jIChy\nZXEsIHJlcykgPT4gewogIGNvbnNvbGUubG9nKCc9PT0gT0F1dGggQ2FsbGJh\nY2sgUmVjZWl2ZWQgPT09Jyk7CiAgY29uc29sZS5sb2coJ1F1ZXJ5IHBhcmFt\nczonLCByZXEucXVlcnkpOwogIAogIGNvbnN0IHsgY29kZSwgbG9jYXRpb25f\naWQsIGVycm9yLCBlcnJvcl9kZXNjcmlwdGlvbiB9ID0gcmVxLnF1ZXJ5Owog\nIAogIGlmIChlcnJvcikgewogICAgY29uc29sZS5sb2coJ+KdjCBPQXV0aCBl\ncnJvcjonLCBlcnJvciwgZXJyb3JfZGVzY3JpcHRpb24pOwogICAgcmV0dXJu\nIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGA8aHRtbD48Ym9keT4KICAgICAgPGgy\nPk9BdXRoIEVycm9yPC9oMj4KICAgICAgPHA+RXJyb3I6ICR7ZXJyb3J9PC9w\nPgogICAgICA8cD5EZXNjcmlwdGlvbjogJHtlcnJvcl9kZXNjcmlwdGlvbn08\nL3A+CiAgICAgIDxhIGhyZWY9Imh0dHBzOi8vbGlzdGluZ3MuZW5nYWdlYXV0\nb21hdGlvbnMuY29tIj5SZXR1cm4gdG8gQXBwbGljYXRpb248L2E+CiAgICA8\nL2JvZHk+PC9odG1sPmApOwogIH0KICAKICBpZiAoIWNvZGUpIHsKICAgIGNv\nbnNvbGUubG9nKCfinYwgTm8gYXV0aG9yaXphdGlvbiBjb2RlIHJlY2VpdmVk\nJyk7CiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoJzxodG1sPjxi\nb2R5PjxoMj5FcnJvcjogTm8gYXV0aG9yaXphdGlvbiBjb2RlIHJlY2VpdmVk\nPC9oMj48YSBocmVmPSJodHRwczovL2xpc3RpbmdzLmVuZ2FnZWF1dG9tYXRp\nb25zLmNvbSI+UmV0dXJuIHRvIEFwcGxpY2F0aW9uPC9hPjwvYm9keT48L2h0\nbWw+Jyk7CiAgfQogIAogIHRyeSB7CiAgICBjb25zb2xlLmxvZygn8J+UhCBF\neGNoYW5naW5nIGF1dGhvcml6YXRpb24gY29kZSBmb3IgdG9rZW5zLi4uJyk7\nCiAgICBjb25zb2xlLmxvZygnICAgQ29kZTonLCBjb2RlLnN1YnN0cmluZygw\nLCAyMCkgKyAnLi4uJyk7CiAgICBjb25zb2xlLmxvZygnICAgTG9jYXRpb24g\nSUQ6JywgbG9jYXRpb25faWQpOwogICAgY29uc29sZS5sb2coJyAgIENsaWVu\ndCBJRDonLCBDTElFTlRfSUQpOwogICAgY29uc29sZS5sb2coJyAgIFJlZGly\nZWN0IFVSSTonLCBSRURJUkVDVF9VUkkpOwogICAgCiAgICAvLyBFeGNoYW5n\nZSBjb2RlIGZvciB0b2tlbnMgdXNpbmcgVVJMU2VhcmNoUGFyYW1zCiAgICBj\nb25zdCB0b2tlblBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTsKICAg\nIHRva2VuUGFyYW1zLmFwcGVuZCgnY2xpZW50X2lkJywgQ0xJRU5UX0lEKTsK\nICAgIHRva2VuUGFyYW1zLmFwcGVuZCgnY2xpZW50X3NlY3JldCcsIENMSUVO\nVF9TRUNSRVQpOwogICAgdG9rZW5QYXJhbXMuYXBwZW5kKCdncmFudF90eXBl\nJywgJ2F1dGhvcml6YXRpb25fY29kZScpOwogICAgdG9rZW5QYXJhbXMuYXBw\nZW5kKCdjb2RlJywgY29kZSk7CiAgICB0b2tlblBhcmFtcy5hcHBlbmQoJ3Jl\nZGlyZWN0X3VyaScsIFJFRElSRUNUX1VSSSk7CiAgICAKICAgIGNvbnNvbGUu\nbG9nKCfwn5OhIE1ha2luZyB0b2tlbiBleGNoYW5nZSByZXF1ZXN0IHRvIEdv\nSGlnaExldmVsLi4uJyk7CiAgICAKICAgIGNvbnN0IHRva2VuUmVzcG9uc2Ug\nPSBhd2FpdCBheGlvcy5wb3N0KAogICAgICAnaHR0cHM6Ly9zZXJ2aWNlcy5s\nZWFkY29ubmVjdG9yaHEuY29tL29hdXRoL3Rva2VuJywKICAgICAgdG9rZW5Q\nYXJhbXMsCiAgICAgIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAn\nQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5j\nb2RlZCcsCiAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24n\nCiAgICAgICAgfSwKICAgICAgICB0aW1lb3V0OiAzMDAwMAogICAgICB9CiAg\nICApOwogICAgCiAgICBjb25zdCB7IGFjY2Vzc190b2tlbiwgcmVmcmVzaF90\nb2tlbiwgZXhwaXJlc19pbiwgc2NvcGUgfSA9IHRva2VuUmVzcG9uc2UuZGF0\nYTsKICAgIGNvbnNvbGUubG9nKCfinIUgVG9rZW5zIHJlY2VpdmVkIHN1Y2Nl\nc3NmdWxseScpOwogICAgY29uc29sZS5sb2coJyAgIEV4cGlyZXMgaW46Jywg\nZXhwaXJlc19pbiwgJ3NlY29uZHMnKTsKICAgIGNvbnNvbGUubG9nKCcgICBT\nY29wZXM6Jywgc2NvcGUpOwogICAgY29uc29sZS5sb2coJyAgIEFjY2VzcyB0\nb2tlbiAoZmlyc3QgMjAgY2hhcnMpOicsIGFjY2Vzc190b2tlbi5zdWJzdHJp\nbmcoMCwgMjApICsgJy4uLicpOwogICAgCiAgICAvLyBHZW5lcmF0ZSBpbnN0\nYWxsYXRpb24gSUQKICAgIGNvbnN0IGluc3RhbGxhdGlvbl9pZCA9IGBpbnN0\nYWxsXyR7RGF0ZS5ub3coKX1gOwogICAgCiAgICAvLyBTdG9yZSBpbnN0YWxs\nYXRpb24gd2l0aCB0b2tlbnMKICAgIGluc3RhbGxhdGlvbnMuc2V0KGluc3Rh\nbGxhdGlvbl9pZCwgewogICAgICBpZDogaW5zdGFsbGF0aW9uX2lkLAogICAg\nICBhY2Nlc3NUb2tlbjogYWNjZXNzX3Rva2VuLAogICAgICByZWZyZXNoVG9r\nZW46IHJlZnJlc2hfdG9rZW4sCiAgICAgIGV4cGlyZXNJbjogZXhwaXJlc19p\nbiwKICAgICAgZXhwaXJlc0F0OiBEYXRlLm5vdygpICsgKGV4cGlyZXNfaW4g\nKiAxMDAwKSwKICAgICAgbG9jYXRpb25JZDogbG9jYXRpb25faWQsCiAgICAg\nIHNjb3Blczogc2NvcGUsCiAgICAgIHRva2VuU3RhdHVzOiAndmFsaWQnLAog\nICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwKICAg\nICAgbGFzdFJlZnJlc2g6IG51bGwKICAgIH0pOwogICAgCiAgICBjb25zb2xl\nLmxvZyhg4pyFIEluc3RhbGxhdGlvbiAke2luc3RhbGxhdGlvbl9pZH0gc3Rv\ncmVkIHN1Y2Nlc3NmdWxseWApOwogICAgY29uc29sZS5sb2coJyAgIFRvdGFs\nIGluc3RhbGxhdGlvbnM6JywgaW5zdGFsbGF0aW9ucy5zaXplKTsKICAgIAog\nICAgLy8gUmVkaXJlY3QgdG8gZnJvbnRlbmQgd2l0aCBpbnN0YWxsYXRpb24g\nZGV0YWlscwogICAgY29uc3QgZnJvbnRlbmRVcmwgPSBgaHR0cHM6Ly9saXN0\naW5ncy5lbmdhZ2VhdXRvbWF0aW9ucy5jb20vP2luc3RhbGxhdGlvbl9pZD0k\ne2luc3RhbGxhdGlvbl9pZH0md2VsY29tZT10cnVlYDsKICAgIAogICAgcmVz\nLnNlbmQoYDxodG1sPjxoZWFkPjx0aXRsZT5PQXV0aCBTdWNjZXNzPC90aXRs\nZT48L2hlYWQ+PGJvZHkgc3R5bGU9ImZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fu\ncy1zZXJpZjsgbWF4LXdpZHRoOiA2MDBweDsgbWFyZ2luOiA1MHB4IGF1dG87\nIHBhZGRpbmc6IDIwcHg7Ij4KICAgICAgPGRpdiBzdHlsZT0idGV4dC1hbGln\nbjogY2VudGVyOyBiYWNrZ3JvdW5kOiAjZjBmOWZmOyBwYWRkaW5nOiAzMHB4\nOyBib3JkZXItcmFkaXVzOiAxMHB4OyBib3JkZXI6IDJweCBzb2xpZCAjMGVh\nNWU5OyI+CiAgICAgICAgPGgyIHN0eWxlPSJjb2xvcjogIzBlYTVlOTsgbWFy\nZ2luLWJvdHRvbTogMjBweDsiPvCfjokgT0F1dGggSW5zdGFsbGF0aW9uIFN1\nY2Nlc3NmdWwhPC9oMj4KICAgICAgICA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5k\nOiB3aGl0ZTsgcGFkZGluZzogMjBweDsgYm9yZGVyLXJhZGl1czogOHB4OyBt\nYXJnaW46IDIwcHggMDsiPgogICAgICAgICAgPHA+PHN0cm9uZz5JbnN0YWxs\nYXRpb24gSUQ6PC9zdHJvbmc+IDxjb2RlPiR7aW5zdGFsbGF0aW9uX2lkfTwv\nY29kZT48L3A+CiAgICAgICAgICA8cD48c3Ryb25nPkxvY2F0aW9uIElEOjwv\nc3Ryb25nPiA8Y29kZT4ke2xvY2F0aW9uX2lkfTwvY29kZT48L3A+CiAgICAg\nICAgICA8cD48c3Ryb25nPlRva2VuIFN0YXR1czo8L3N0cm9uZz4gPHNwYW4g\nc3R5bGU9ImNvbG9yOiBncmVlbjsiPuKchSBWYWxpZDwvc3Bhbj48L3A+CiAg\nICAgICAgICA8cD48c3Ryb25nPlNjb3Blczo8L3N0cm9uZz4gPGNvZGU+JHtz\nY29wZX08L2NvZGU+PC9wPgogICAgICAgIDwvZGl2PgogICAgICAgIDxwIHN0\neWxlPSJjb2xvcjogIzY2NjsiPlJlZGlyZWN0aW5nIHRvIGFwcGxpY2F0aW9u\nIGluIDMgc2Vjb25kcy4uLjwvcD4KICAgICAgICA8ZGl2IHN0eWxlPSJtYXJn\naW4tdG9wOiAyMHB4OyI+CiAgICAgICAgICA8YSBocmVmPSIke2Zyb250ZW5k\nVXJsfSIgc3R5bGU9ImJhY2tncm91bmQ6ICMwZWE1ZTk7IGNvbG9yOiB3aGl0\nZTsgcGFkZGluZzogMTBweCAyMHB4OyB0ZXh0LWRlY29yYXRpb246IG5vbmU7\nIGJvcmRlci1yYWRpdXM6IDVweDsiPkdvIHRvIEFwcGxpY2F0aW9uPC9hPgog\nICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICAgICAgPHNjcmlwdD4KICAg\nICAgICBjb25zb2xlLmxvZygnT0F1dGggaW5zdGFsbGF0aW9uIHN1Y2Nlc3Nm\ndWw6JywgewogICAgICAgICAgaW5zdGFsbGF0aW9uX2lkOiAnJHtpbnN0YWxs\nYXRpb25faWR9JywKICAgICAgICAgIGxvY2F0aW9uX2lkOiAnJHtsb2NhdGlv\nbl9pZH0nLAogICAgICAgICAgc2NvcGVzOiAnJHtzY29wZX0nCiAgICAgICAg\nfSk7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICB3aW5k\nb3cubG9jYXRpb24uaHJlZiA9ICcke2Zyb250ZW5kVXJsfSc7CiAgICAgICAg\nfSwgMzAwMCk7CiAgICAgIDwvc2NyaXB0PgogICAgPC9ib2R5PjwvaHRtbD5g\nKTsKICAgIAogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9y\nKCfinYwgVG9rZW4gZXhjaGFuZ2UgZXJyb3I6JywgZXJyb3IpOwogICAgCiAg\nICBsZXQgZXJyb3JEZXRhaWxzID0gJ1Vua25vd24gZXJyb3InOwogICAgbGV0\nIHN0YXR1c0NvZGUgPSA1MDA7CiAgICAKICAgIGlmIChlcnJvci5yZXNwb25z\nZSkgewogICAgICBjb25zb2xlLmVycm9yKCcgICBTdGF0dXM6JywgZXJyb3Iu\ncmVzcG9uc2Uuc3RhdHVzKTsKICAgICAgY29uc29sZS5lcnJvcignICAgRGF0\nYTonLCBlcnJvci5yZXNwb25zZS5kYXRhKTsKICAgICAgY29uc29sZS5lcnJv\ncignICAgSGVhZGVyczonLCBlcnJvci5yZXNwb25zZS5oZWFkZXJzKTsKICAg\nICAgCiAgICAgIHN0YXR1c0NvZGUgPSBlcnJvci5yZXNwb25zZS5zdGF0dXM7\nCiAgICAgIGVycm9yRGV0YWlscyA9IEpTT04uc3RyaW5naWZ5KGVycm9yLnJl\nc3BvbnNlLmRhdGEsIG51bGwsIDIpOwogICAgICAKICAgICAgLy8gQ2hlY2sg\nZm9yIHNwZWNpZmljIE9BdXRoIGVycm9ycwogICAgICBpZiAoZXJyb3IucmVz\ncG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICBlcnJvckRldGFpbHMg\nPSAnSW52YWxpZCBPQXV0aCBjcmVkZW50aWFscyAtIGNoZWNrIGNsaWVudF9p\nZCBhbmQgY2xpZW50X3NlY3JldCc7CiAgICAgIH0gZWxzZSBpZiAoZXJyb3Iu\ncmVzcG9uc2Uuc3RhdHVzID09PSA0MDApIHsKICAgICAgICBlcnJvckRldGFp\nbHMgPSBlcnJvci5yZXNwb25zZS5kYXRhPy5lcnJvcl9kZXNjcmlwdGlvbiB8\nfCAnSW52YWxpZCBPQXV0aCByZXF1ZXN0JzsKICAgICAgfQogICAgfQogICAg\nCiAgICByZXMuc3RhdHVzKHN0YXR1c0NvZGUpLnNlbmQoYDxodG1sPjxoZWFk\nPjx0aXRsZT5PQXV0aCBGYWlsZWQ8L3RpdGxlPjwvaGVhZD48Ym9keSBzdHls\nZT0iZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOyBtYXgtd2lkdGg6\nIDYwMHB4OyBtYXJnaW46IDUwcHggYXV0bzsgcGFkZGluZzogMjBweDsiPgog\nICAgICA8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7IGJhY2tncm91\nbmQ6ICNmZWYyZjI7IHBhZGRpbmc6IDMwcHg7IGJvcmRlci1yYWRpdXM6IDEw\ncHg7IGJvcmRlcjogMnB4IHNvbGlkICNlZjQ0NDQ7Ij4KICAgICAgICA8aDIg\nc3R5bGU9ImNvbG9yOiAjZWY0NDQ0OyI+4p2MIE9BdXRoIEluc3RhbGxhdGlv\nbiBGYWlsZWQ8L2gyPgogICAgICAgIDxkaXYgc3R5bGU9ImJhY2tncm91bmQ6\nIHdoaXRlOyBwYWRkaW5nOiAyMHB4OyBib3JkZXItcmFkaXVzOiA4cHg7IG1h\ncmdpbjogMjBweCAwOyB0ZXh0LWFsaWduOiBsZWZ0OyI+CiAgICAgICAgICA8\ncD48c3Ryb25nPkVycm9yOjwvc3Ryb25nPiAke2Vycm9yLm1lc3NhZ2V9PC9w\nPgogICAgICAgICAgPHA+PHN0cm9uZz5EZXRhaWxzOjwvc3Ryb25nPiAke2Vy\ncm9yRGV0YWlsc308L3A+CiAgICAgICAgICA8cD48c3Ryb25nPlN0YXR1cyBD\nb2RlOjwvc3Ryb25nPiAke3N0YXR1c0NvZGV9PC9wPgogICAgICAgIDwvZGl2\nPgogICAgICAgIDxwPlBsZWFzZSB0cnkgdGhlIGluc3RhbGxhdGlvbiBhZ2Fp\nbiBvciBjb250YWN0IHN1cHBvcnQuPC9wPgogICAgICAgIDxhIGhyZWY9Imh0\ndHBzOi8vbGlzdGluZ3MuZW5nYWdlYXV0b21hdGlvbnMuY29tIiBzdHlsZT0i\nYmFja2dyb3VuZDogI2VmNDQ0NDsgY29sb3I6IHdoaXRlOyBwYWRkaW5nOiAx\nMHB4IDIwcHg7IHRleHQtZGVjb3JhdGlvbjogbm9uZTsgYm9yZGVyLXJhZGl1\nczogNXB4OyI+UmV0dXJuIHRvIEFwcGxpY2F0aW9uPC9hPgogICAgICAgIAog\nICAgICAgIDxkZXRhaWxzIHN0eWxlPSJtYXJnaW4tdG9wOiAyMHB4OyB0ZXh0\nLWFsaWduOiBsZWZ0OyI+CiAgICAgICAgICA8c3VtbWFyeSBzdHlsZT0iY3Vy\nc29yOiBwb2ludGVyOyBmb250LXdlaWdodDogYm9sZDsiPkRlYnVnIEluZm9y\nbWF0aW9uPC9zdW1tYXJ5PgogICAgICAgICAgPHByZSBzdHlsZT0iYmFja2dy\nb3VuZDogI2Y1ZjVmNTsgcGFkZGluZzogMTBweDsgYm9yZGVyLXJhZGl1czog\nNXB4OyBmb250LXNpemU6IDEycHg7Ij4KQ2xpZW50IElEOiAke0NMSUVOVF9J\nRH0KUmVkaXJlY3QgVVJJOiAke1JFRElSRUNUX1VSSX0KQXV0aG9yaXphdGlv\nbiBDb2RlOiAke2NvZGU/LnN1YnN0cmluZygwLCAyMCl9Li4uCkxvY2F0aW9u\nIElEOiAke2xvY2F0aW9uX2lkfQogICAgICAgICAgPC9wcmU+CiAgICAgICAg\nPC9kZXRhaWxzPgogICAgICA8L2Rpdj4KICAgIDwvYm9keT48L2h0bWw+YCk7\nCiAgfQp9KTsKCi8vIFRva2VuIEFjY2VzcyBCcmlkZ2UgZm9yIEFQSSBCYWNr\nZW5kCmFwcC5wb3N0KCcvYXBpL3Rva2VuLWFjY2VzcycsIGFzeW5jIChyZXEs\nIHJlcykgPT4gewogIHRyeSB7CiAgICBjb25zdCB7IGluc3RhbGxhdGlvbl9p\nZCB9ID0gcmVxLmJvZHk7CiAgICAKICAgIGlmICghaW5zdGFsbGF0aW9uX2lk\nKSB7CiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IHN1Y2Nl\nc3M6IGZhbHNlLCBlcnJvcjogJ2luc3RhbGxhdGlvbl9pZCByZXF1aXJlZCcg\nfSk7CiAgICB9CiAgICAKICAgIGNvbnN0IGluc3RhbGxhdGlvbiA9IGluc3Rh\nbGxhdGlvbnMuZ2V0KGluc3RhbGxhdGlvbl9pZCk7CiAgICAKICAgIGlmICgh\naW5zdGFsbGF0aW9uKSB7CiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCku\nanNvbih7IAogICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCAKICAgICAgICBlcnJv\ncjogJ0luc3RhbGxhdGlvbiBub3QgZm91bmQnLAogICAgICAgIGhpbnQ6ICdQ\nbGVhc2UgY29tcGxldGUgT0F1dGggaW5zdGFsbGF0aW9uIGZpcnN0JywKICAg\nICAgICBhdmFpbGFibGVfaW5zdGFsbGF0aW9uczogQXJyYXkuZnJvbShpbnN0\nYWxsYXRpb25zLmtleXMoKSkKICAgICAgfSk7CiAgICB9CiAgICAKICAgIC8v\nIENoZWNrIGlmIHRva2VuIG5lZWRzIHJlZnJlc2ggKHdpdGhpbiAxMCBtaW51\ndGVzIG9mIGV4cGlyeSkKICAgIGNvbnN0IG5lZWRzUmVmcmVzaCA9IChpbnN0\nYWxsYXRpb24uZXhwaXJlc0F0IC0gRGF0ZS5ub3coKSkgPCAoMTAgKiA2MCAq\nIDEwMDApOwogICAgCiAgICBpZiAobmVlZHNSZWZyZXNoICYmIGluc3RhbGxh\ndGlvbi5yZWZyZXNoVG9rZW4pIHsKICAgICAgY29uc29sZS5sb2coYPCflIQg\nUmVmcmVzaGluZyB0b2tlbiBmb3IgaW5zdGFsbGF0aW9uICR7aW5zdGFsbGF0\naW9uX2lkfWApOwogICAgICAKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBy\nZWZyZXNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpOwogICAgICAg\nIHJlZnJlc2hQYXJhbXMuYXBwZW5kKCdjbGllbnRfaWQnLCBDTElFTlRfSUQp\nOwogICAgICAgIHJlZnJlc2hQYXJhbXMuYXBwZW5kKCdjbGllbnRfc2VjcmV0\nJywgQ0xJRU5UX1NFQ1JFVCk7CiAgICAgICAgcmVmcmVzaFBhcmFtcy5hcHBl\nbmQoJ2dyYW50X3R5cGUnLCAncmVmcmVzaF90b2tlbicpOwogICAgICAgIHJl\nZnJlc2hQYXJhbXMuYXBwZW5kKCdyZWZyZXNoX3Rva2VuJywgaW5zdGFsbGF0\naW9uLnJlZnJlc2hUb2tlbik7CiAgICAgICAgCiAgICAgICAgY29uc3QgcmVm\ncmVzaFJlc3BvbnNlID0gYXdhaXQgYXhpb3MucG9zdCgKICAgICAgICAgICdo\ndHRwczovL3NlcnZpY2VzLmxlYWRjb25uZWN0b3JocS5jb20vb2F1dGgvdG9r\nZW4nLAogICAgICAgICAgcmVmcmVzaFBhcmFtcywKICAgICAgICAgIHsKICAg\nICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICdDb250ZW50LVR5\ncGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJywKICAg\nICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAg\nICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICApOwogICAgICAgIAogICAg\nICAgIGNvbnN0IHsgYWNjZXNzX3Rva2VuLCByZWZyZXNoX3Rva2VuLCBleHBp\ncmVzX2luIH0gPSByZWZyZXNoUmVzcG9uc2UuZGF0YTsKICAgICAgICAKICAg\nICAgICAvLyBVcGRhdGUgaW5zdGFsbGF0aW9uIHdpdGggbmV3IHRva2Vucwog\nICAgICAgIGluc3RhbGxhdGlvbi5hY2Nlc3NUb2tlbiA9IGFjY2Vzc190b2tl\nbjsKICAgICAgICBpbnN0YWxsYXRpb24ucmVmcmVzaFRva2VuID0gcmVmcmVz\naF90b2tlbiB8fCBpbnN0YWxsYXRpb24ucmVmcmVzaFRva2VuOwogICAgICAg\nIGluc3RhbGxhdGlvbi5leHBpcmVzSW4gPSBleHBpcmVzX2luOwogICAgICAg\nIGluc3RhbGxhdGlvbi5leHBpcmVzQXQgPSBEYXRlLm5vdygpICsgKGV4cGly\nZXNfaW4gKiAxMDAwKTsKICAgICAgICBpbnN0YWxsYXRpb24ubGFzdFJlZnJl\nc2ggPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7CiAgICAgICAgaW5zdGFs\nbGF0aW9uLnRva2VuU3RhdHVzID0gJ3JlZnJlc2hlZCc7CiAgICAgICAgCiAg\nICAgICAgaW5zdGFsbGF0aW9ucy5zZXQoaW5zdGFsbGF0aW9uX2lkLCBpbnN0\nYWxsYXRpb24pOwogICAgICAgIAogICAgICAgIGNvbnNvbGUubG9nKGDinIUg\nVG9rZW4gcmVmcmVzaGVkIGZvciBpbnN0YWxsYXRpb24gJHtpbnN0YWxsYXRp\nb25faWR9YCk7CiAgICAgICAgCiAgICAgIH0gY2F0Y2ggKHJlZnJlc2hFcnJv\ncikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBUb2tlbiByZWZyZXNo\nIGZhaWxlZDonLCByZWZyZXNoRXJyb3IpOwogICAgICAgIGluc3RhbGxhdGlv\nbi50b2tlblN0YXR1cyA9ICdyZWZyZXNoX2ZhaWxlZCc7CiAgICAgICAgaW5z\ndGFsbGF0aW9ucy5zZXQoaW5zdGFsbGF0aW9uX2lkLCBpbnN0YWxsYXRpb24p\nOwogICAgICB9CiAgICB9CiAgICAKICAgIHJlcy5qc29uKHsKICAgICAgc3Vj\nY2VzczogdHJ1ZSwKICAgICAgYWNjZXNzVG9rZW46IGluc3RhbGxhdGlvbi5h\nY2Nlc3NUb2tlbiwKICAgICAgaW5zdGFsbGF0aW9uOiB7CiAgICAgICAgaWQ6\nIGluc3RhbGxhdGlvbi5pZCwKICAgICAgICBsb2NhdGlvbklkOiBpbnN0YWxs\nYXRpb24ubG9jYXRpb25JZCwKICAgICAgICB0b2tlblN0YXR1czogaW5zdGFs\nbGF0aW9uLnRva2VuU3RhdHVzLAogICAgICAgIGV4cGlyZXNBdDogaW5zdGFs\nbGF0aW9uLmV4cGlyZXNBdCwKICAgICAgICBzY29wZXM6IGluc3RhbGxhdGlv\nbi5zY29wZXMKICAgICAgfQogICAgfSk7CiAgICAKICB9IGNhdGNoIChlcnJv\ncikgewogICAgY29uc29sZS5lcnJvcignVG9rZW4gYWNjZXNzIGVycm9yOics\nIGVycm9yKTsKICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsKICAgICAgc3Vj\nY2VzczogZmFsc2UsCiAgICAgIGVycm9yOiAnVG9rZW4gYWNjZXNzIGZhaWxl\nZCcKICAgIH0pOwogIH0KfSk7CgovLyBJbnN0YWxsYXRpb24gU3RhdHVzCmFw\ncC5nZXQoJy9pbnN0YWxsYXRpb25zJywgKHJlcSwgcmVzKSA9PiB7CiAgY29u\nc3QgaW5zdGFsbExpc3QgPSBBcnJheS5mcm9tKGluc3RhbGxhdGlvbnMudmFs\ndWVzKCkpLm1hcChpbnN0YWxsID0+ICh7CiAgICBpZDogaW5zdGFsbC5pZCwK\nICAgIGxvY2F0aW9uSWQ6IGluc3RhbGwubG9jYXRpb25JZCwKICAgIHRva2Vu\nU3RhdHVzOiBpbnN0YWxsLnRva2VuU3RhdHVzLAogICAgY3JlYXRlZEF0OiBp\nbnN0YWxsLmNyZWF0ZWRBdCwKICAgIGxhc3RSZWZyZXNoOiBpbnN0YWxsLmxh\nc3RSZWZyZXNoLAogICAgZXhwaXJlc0F0OiBpbnN0YWxsLmV4cGlyZXNBdCwK\nICAgIHNjb3BlczogaW5zdGFsbC5zY29wZXMKICB9KSk7CiAgCiAgcmVzLmpz\nb24oewogICAgY291bnQ6IGluc3RhbGxMaXN0Lmxlbmd0aCwKICAgIGluc3Rh\nbGxhdGlvbnM6IGluc3RhbGxMaXN0LAogICAgb2F1dGhfY29uZmlnOiB7CiAg\nICAgIGNsaWVudF9pZDogQ0xJRU5UX0lELAogICAgICByZWRpcmVjdF91cmk6\nIFJFRElSRUNUX1VSSQogICAgfQogIH0pOwp9KTsKCi8vIERlYnVnIGVuZHBv\naW50CmFwcC5nZXQoJy9kZWJ1ZycsIChyZXEsIHJlcykgPT4gewogIHJlcy5q\nc29uKHsKICAgIHNlcnZpY2U6ICdPQXV0aCBCYWNrZW5kIERlYnVnJywKICAg\nIG9hdXRoX2NvbmZpZzogewogICAgICBjbGllbnRfaWQ6IENMSUVOVF9JRCwK\nICAgICAgcmVkaXJlY3RfdXJpOiBSRURJUkVDVF9VUkksCiAgICAgIGNhbGxi\nYWNrX3VybDogJ2h0dHBzOi8vZGlyLmVuZ2FnZWF1dG9tYXRpb25zLmNvbS9h\ncGkvb2F1dGgvY2FsbGJhY2snCiAgICB9LAogICAgaW5zdGFsbGF0aW9uczog\newogICAgICBjb3VudDogaW5zdGFsbGF0aW9ucy5zaXplLAogICAgICBpZHM6\nIEFycmF5LmZyb20oaW5zdGFsbGF0aW9ucy5rZXlzKCkpCiAgICB9LAogICAg\nbGFzdF9yZXF1ZXN0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkKICB9KTsK\nfSk7CgovLyBIZWFsdGggQ2hlY2sKYXBwLmdldCgnL2hlYWx0aCcsIChyZXEs\nIHJlcykgPT4gewogIHJlcy5qc29uKHsKICAgIHN0YXR1czogJ2hlYWx0aHkn\nLAogICAgc2VydmljZTogJ1B1cmUgT0F1dGggQmFja2VuZCcsCiAgICB2ZXJz\naW9uOiAnNi4xLjAtY29ycmVjdC1jcmVkZW50aWFscycsCiAgICBmZWF0dXJl\nczogWydvYXV0aC1jYWxsYmFjaycsICd0b2tlbi1tYW5hZ2VtZW50JywgJ2Fw\naS1icmlkZ2UnXSwKICAgIGluc3RhbGxhdGlvbnM6IGluc3RhbGxhdGlvbnMu\nc2l6ZSwKICAgIG9hdXRoX2NvbmZpZzogewogICAgICBjbGllbnRfaWQ6IENM\nSUVOVF9JRCwKICAgICAgcmVkaXJlY3RfdXJpOiBSRURJUkVDVF9VUkkKICAg\nIH0sCiAgICB0aW1lc3RhbXA6IERhdGUubm93KCkKICB9KTsKfSk7CgovLyBS\nb290IFN0YXR1cwphcHAuZ2V0KCcvJywgKHJlcSwgcmVzKSA9PiB7CiAgcmVz\nLmpzb24oewogICAgc2VydmljZTogJ0dvSGlnaExldmVsIE9BdXRoIEJhY2tl\nbmQnLAogICAgdmVyc2lvbjogJzYuMS4wLWNvcnJlY3QtY3JlZGVudGlhbHMn\nLCAKICAgIHB1cnBvc2U6ICdPQXV0aCBhdXRoZW50aWNhdGlvbiBvbmx5JywK\nICAgIGVuZHBvaW50czogWwogICAgICAnR0VUIC9hcGkvb2F1dGgvY2FsbGJh\nY2snLAogICAgICAnUE9TVCAvYXBpL3Rva2VuLWFjY2VzcycsCiAgICAgICdH\nRVQgL2luc3RhbGxhdGlvbnMnLAogICAgICAnR0VUIC9kZWJ1ZycsCiAgICAg\nICdHRVQgL2hlYWx0aCcKICAgIF0sCiAgICBpbnN0YWxsYXRpb25zOiBpbnN0\nYWxsYXRpb25zLnNpemUsCiAgICBzdGF0dXM6ICdvcGVyYXRpb25hbCcKICB9\nKTsKfSk7CgphcHAubGlzdGVuKHBvcnQsICgpID0+IHsKICBjb25zb2xlLmxv\nZyhgUHVyZSBPQXV0aCBCYWNrZW5kIHY2LjEuMCBydW5uaW5nIG9uIHBvcnQg\nJHtwb3J0fWApOwogIGNvbnNvbGUubG9nKCdPQXV0aCBDcmVkZW50aWFsczog\nVVBEQVRFRCB3aXRoIGNvcnJlY3QgY2xpZW50X2lkIGFuZCBjbGllbnRfc2Vj\ncmV0Jyk7CiAgY29uc29sZS5sb2coJ1B1cnBvc2U6IE9BdXRoIGF1dGhlbnRp\nY2F0aW9uIGFuZCB0b2tlbiBtYW5hZ2VtZW50IG9ubHknKTsKICBjb25zb2xl\nLmxvZygnQVBJIEJhY2tlbmQ6IFNlcGFyYXRlIHNlcnZpY2UgaGFuZGxlcyBH\nb0hpZ2hMZXZlbCBBUEkgY2FsbHMnKTsKfSk7\n",
  "encoding": "base64",
  "_links": {
    "self": "https://api.github.com/repos/EngageAutomations/oauth-backend/contents/index.js?ref=main",
    "git": "https://api.github.com/repos/EngageAutomations/oauth-backend/git/blobs/5f603275485c262ad6226e3f48b9b1780cd32d57",
    "html": "https://github.com/EngageAutomations/oauth-backend/blob/main/index.js"
  }
}
