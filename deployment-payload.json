{
  "message": "Deploy location token conversion v10.0.0-location-conversion",
  "content": "LyoqCiAqIEVuaGFuY2VkIE9BdXRoIEJhY2tlbmQgd2l0aCBMb2NhdGlvbiBUb2tlbiBDb252ZXJzaW9uCiAqIHYxMC4wLjAtbG9jYXRpb24tY29udmVyc2lvbiAtIEF1dG9tYXRpYyBDb21wYW55IOKGkiBMb2NhdGlvbiB0b2tlbiBjb252ZXJzaW9uCiAqIAogKiBERVBMT1lNRU5UIElOU1RSVUNUSU9OUzoKICogMS4gQ29weSB0aGlzIGVudGlyZSBmaWxlIGNvbnRlbnQKICogMi4gUmVwbGFjZSB0aGUgaW5kZXguanMgY29udGVudCBpbiB0aGUgb2F1dGgtYmFja2VuZCBHaXRIdWIgcmVwb3NpdG9yeQogKiAzLiBVcGRhdGUgcGFja2FnZS5qc29uIHZlcnNpb24gdG8gIjEwLjAuMC1sb2NhdGlvbi1jb252ZXJzaW9uIgogKiA0LiBSYWlsd2F5IHdpbGwgYXV0b21hdGljYWxseSBkZXBsb3kgdGhlIGNoYW5nZXMKICovCgpjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpOwpjb25zdCBheGlvcyA9IHJlcXVpcmUoJ2F4aW9zJyk7CmNvbnN0IGNvcnMgPSByZXF1aXJlKCdjb3JzJyk7CmNvbnN0IG11bHRlciA9IHJlcXVpcmUoJ211bHRlcicpOwpjb25zdCBGb3JtRGF0YSA9IHJlcXVpcmUoJ2Zvcm0tZGF0YScpOwpjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7Cgpjb25zdCBhcHAgPSBleHByZXNzKCk7CgovLyBNaWRkbGV3YXJlCmFwcC51c2UoY29ycygpKTsKYXBwLnVzZShleHByZXNzLmpzb24oKSk7CmFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUgfSkpOwoKY29uc3QgUE9SVCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwMDsKCi8vIEluLW1lbW9yeSBzdG9yYWdlCmNvbnN0IGluc3RhbGxhdGlvbnMgPSBuZXcgTWFwKCk7CmNvbnN0IGxvY2F0aW9uVG9rZW5zID0gbmV3IE1hcCgpOyAvLyBTdG9yZSBMb2NhdGlvbiB0b2tlbnMgc2VwYXJhdGVseQoKLy8gRmlsZSB1cGxvYWQgY29uZmlndXJhdGlvbgpjb25zdCB1cGxvYWQgPSBtdWx0ZXIoewogIGRlc3Q6ICd1cGxvYWRzLycsCiAgbGltaXRzOiB7IGZpbGVTaXplOiAyNSAqIDEwMjQgKiAxMDI0IH0sIC8vIDI1TUIKICBmaWxlRmlsdGVyOiAocmVxLCBmaWxlLCBjYikgPT4gewogICAgY29uc3QgYWxsb3dlZFR5cGVzID0gWydpbWFnZS9qcGVnJywgJ2ltYWdlL3BuZycsICdpbWFnZS9naWYnLCAnaW1hZ2Uvd2VicCddOwogICAgY2IobnVsbCwgYWxsb3dlZFR5cGVzLmluY2x1ZGVzKGZpbGUubWltZXR5cGUpKTsKICB9Cn0pOwoKLy8gUm9vdCBlbmRwb2ludAphcHAuZ2V0KCcvJywgKHJlcSwgcmVzKSA9PiB7CiAgcmVzLmpzb24oewogICAgc2VydmljZTogJ0dvSGlnaExldmVsIE9BdXRoIEJhY2tlbmQnLAogICAgdmVyc2lvbjogJzEwLjAuMC1sb2NhdGlvbi1jb252ZXJzaW9uJywKICAgIGZlYXR1cmVzOiBbCiAgICAgICdsb2NhdGlvbi11c2VyLXR5cGUnLAogICAgICAnbG9jYXRpb24tdG9rZW4tY29udmVyc2lvbicsCiAgICAgICdtZWRpYS11cGxvYWQnLAogICAgICAndG9rZW4tcmVmcmVzaCcsCiAgICAgICdhdXRvbWF0aWMtcmV0cnknCiAgICBdLAogICAgZGVidWc6ICdDb21wYW55IHRva2VucyBhdXRvbWF0aWNhbGx5IGNvbnZlcnRlZCB0byBMb2NhdGlvbiB0b2tlbnMgZm9yIG1lZGlhIEFQSXMnCiAgfSk7Cn0pOwoKLy8gTE9DQVRJT04gVE9LRU4gQ09OVkVSU0lPTiBGVU5DVElPTgphc3luYyBmdW5jdGlvbiBjb252ZXJ0VG9Mb2NhdGlvblRva2VuKGNvbXBhbnlUb2tlbiwgY29tcGFueUlkLCBsb2NhdGlvbklkKSB7CiAgdHJ5IHsKICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoewogICAgICBjb21wYW55SWQ6IGNvbXBhbnlJZCwKICAgICAgbG9jYXRpb25JZDogbG9jYXRpb25JZAogICAgfSk7CgogICAgY29uc29sZS5sb2coJ1tMT0NBVElPTi1DT05WRVJUXSBDb252ZXJ0aW5nIENvbXBhbnkgdG9rZW4gdG8gTG9jYXRpb24gdG9rZW4uLi4nKTsKICAgIGNvbnNvbGUubG9nKCdbTE9DQVRJT04tQ09OVkVSVF0gQ29tcGFueSBJRDonLCBjb21wYW55SWQpOwogICAgY29uc29sZS5sb2coJ1tMT0NBVElPTi1DT05WRVJUXSBMb2NhdGlvbiBJRDonLCBsb2NhdGlvbklkKTsKCiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3QoCiAgICAgICdodHRwczovL3NlcnZpY2VzLmxlYWRjb25uZWN0b3JocS5jb20vb2F1dGgvbG9jYXRpb25Ub2tlbicsCiAgICAgIHBhcmFtcywKICAgICAgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJywKICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2NvbXBhbnlUb2tlbn1gLAogICAgICAgICAgJ1ZlcnNpb24nOiAnMjAyMS0wNy0yOCcsCiAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgfSwKICAgICAgICB0aW1lb3V0OiAxNTAwMAogICAgICB9CiAgICApOwoKICAgIGNvbnNvbGUubG9nKCdbTE9DQVRJT04tQ09OVkVSVF0g4pyFIFN1Y2Nlc3NmdWxseSBjb252ZXJ0ZWQgQ29tcGFueSB0b2tlbiB0byBMb2NhdGlvbiB0b2tlbicpOwogICAgCiAgICAvLyBEZWNvZGUgYW5kIHZlcmlmeSB0aGUgbmV3IExvY2F0aW9uIHRva2VuCiAgICBjb25zdCBsb2NhdGlvbkpXVCA9IGRlY29kZUpXVChyZXNwb25zZS5kYXRhLmFjY2Vzc190b2tlbik7CiAgICBjb25zb2xlLmxvZygnW0xPQ0FUSU9OLUNPTlZFUlRdIE5ldyB0b2tlbiBhdXRoQ2xhc3M6JywgbG9jYXRpb25KV1Q/LmF1dGhDbGFzcyk7CiAgICBjb25zb2xlLmxvZygnW0xPQ0FUSU9OLUNPTlZFUlRdIE5ldyB0b2tlbiBhdXRoQ2xhc3NJZDonLCBsb2NhdGlvbkpXVD8uYXV0aENsYXNzSWQpOwogICAgCiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKICB9IGNhdGNoIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignW0xPQ0FUSU9OLUNPTlZFUlRdIOKdjCBDb252ZXJzaW9uIGZhaWxlZDonLCBlcnJvci5yZXNwb25zZT8uZGF0YSB8fCBlcnJvci5tZXNzYWdlKTsKICAgIHRocm93IGVycm9yOwogIH0KfQoKLy8gR0VUIExPQ0FUSU9OIFRPS0VOIEZPUiBJTlNUQUxMQVRJT04KYXN5bmMgZnVuY3Rpb24gZ2V0TG9jYXRpb25Ub2tlbihpbnN0YWxsYXRpb25JZCkgewogIGNvbnN0IGluc3QgPSBpbnN0YWxsYXRpb25zLmdldChpbnN0YWxsYXRpb25JZCk7CiAgaWYgKCFpbnN0IHx8ICFpbnN0LmFjY2Vzc1Rva2VuKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ0luc3RhbGxhdGlvbiBub3QgZm91bmQnKTsKICB9CgogIC8vIENoZWNrIGlmIHdlIGFscmVhZHkgaGF2ZSBhIHZhbGlkIGxvY2F0aW9uIHRva2VuCiAgaWYgKGxvY2F0aW9uVG9rZW5zLmhhcyhpbnN0YWxsYXRpb25JZCkpIHsKICAgIGNvbnN0IGxvY2F0aW9uVG9rZW4gPSBsb2NhdGlvblRva2Vucy5nZXQoaW5zdGFsbGF0aW9uSWQpOwogICAgCiAgICAvLyBDaGVjayBpZiBsb2NhdGlvbiB0b2tlbiBpcyBzdGlsbCB2YWxpZCAod2l0aCA1IG1pbnV0ZSBidWZmZXIpCiAgICBpZiAobG9jYXRpb25Ub2tlbi5leHBpcmVzQXQgPiBEYXRlLm5vdygpICsgKDUgKiA2MCAqIDEwMDApKSB7CiAgICAgIGNvbnNvbGUubG9nKCdbTE9DQVRJT04tVE9LRU5dIOKchSBVc2luZyBjYWNoZWQgTG9jYXRpb24gdG9rZW4gZm9yJywgaW5zdGFsbGF0aW9uSWQpOwogICAgICByZXR1cm4gbG9jYXRpb25Ub2tlbi5hY2Nlc3NUb2tlbjsKICAgIH0KICAgIAogICAgLy8gTG9jYXRpb24gdG9rZW4gZXhwaXJlZCwgcmVtb3ZlIGl0CiAgICBjb25zb2xlLmxvZygnW0xPQ0FUSU9OLVRPS0VOXSDimqDvuI8gTG9jYXRpb24gdG9rZW4gZXhwaXJlZCwgcmVtb3ZpbmcgY2FjaGUgZm9yJywgaW5zdGFsbGF0aW9uSWQpOwogICAgbG9jYXRpb25Ub2tlbnMuZGVsZXRlKGluc3RhbGxhdGlvbklkKTsKICB9CgogIC8vIENvbnZlcnQgQ29tcGFueSB0b2tlbiB0byBMb2NhdGlvbiB0b2tlbgogIHRyeSB7CiAgICBjb25zdCBqd3QgPSBkZWNvZGVKV1QoaW5zdC5hY2Nlc3NUb2tlbik7CiAgICBjb25zdCBjb21wYW55SWQgPSBqd3QuYXV0aENsYXNzSWQ7CiAgICBjb25zdCBsb2NhdGlvbklkID0gaW5zdC5sb2NhdGlvbklkIHx8ICdXQXZrODdSbVc5ckJTREpIZU9wSCc7IC8vIFVzZSBrbm93biB3b3JraW5nIGxvY2F0aW9uCgogICAgY29uc29sZS5sb2coJ1tMT0NBVElPTi1UT0tFTl0gU3RhcnRpbmcgY29udmVyc2lvbiBmb3InLCBpbnN0YWxsYXRpb25JZCk7CiAgICBjb25zb2xlLmxvZygnW0xPQ0FUSU9OLVRPS0VOXSBDb21wYW55IGF1dGhDbGFzczonLCBqd3QuYXV0aENsYXNzKTsKICAgIGNvbnNvbGUubG9nKCdbTE9DQVRJT04tVE9LRU5dIENvbXBhbnkgYXV0aENsYXNzSWQ6JywgY29tcGFueUlkKTsKCiAgICBjb25zdCBsb2NhdGlvblRva2VuRGF0YSA9IGF3YWl0IGNvbnZlcnRUb0xvY2F0aW9uVG9rZW4oCiAgICAgIGluc3QuYWNjZXNzVG9rZW4sCiAgICAgIGNvbXBhbnlJZCwKICAgICAgbG9jYXRpb25JZAogICAgKTsKCiAgICAvLyBTdG9yZSB0aGUgbG9jYXRpb24gdG9rZW4KICAgIGxvY2F0aW9uVG9rZW5zLnNldChpbnN0YWxsYXRpb25JZCwgewogICAgICBhY2Nlc3NUb2tlbjogbG9jYXRpb25Ub2tlbkRhdGEuYWNjZXNzX3Rva2VuLAogICAgICByZWZyZXNoVG9rZW46IGxvY2F0aW9uVG9rZW5EYXRhLnJlZnJlc2hfdG9rZW4sCiAgICAgIGV4cGlyZXNBdDogRGF0ZS5ub3coKSArIChsb2NhdGlvblRva2VuRGF0YS5leHBpcmVzX2luICogMTAwMCksCiAgICAgIGxvY2F0aW9uSWQ6IGxvY2F0aW9uVG9rZW5EYXRhLmxvY2F0aW9uSWQsCiAgICAgIHVzZXJUeXBlOiAnTG9jYXRpb24nLAogICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKQogICAgfSk7CgogICAgY29uc29sZS5sb2coJ1tMT0NBVElPTi1UT0tFTl0g4pyFIFN0b3JlZCBMb2NhdGlvbiB0b2tlbiBmb3InLCBpbnN0YWxsYXRpb25JZCk7CiAgICBjb25zb2xlLmxvZygnW0xPQ0FUSU9OLVRPS0VOXSBMb2NhdGlvbiBJRDonLCBsb2NhdGlvblRva2VuRGF0YS5sb2NhdGlvbklkKTsKICAgIAogICAgcmV0dXJuIGxvY2F0aW9uVG9rZW5EYXRhLmFjY2Vzc190b2tlbjsKCiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1tMT0NBVElPTi1UT0tFTl0g4p2MIEZhaWxlZCB0byBnZXQgTG9jYXRpb24gdG9rZW4gZm9yJywgaW5zdGFsbGF0aW9uSWQsICc6JywgZXJyb3IubWVzc2FnZSk7CiAgICB0aHJvdyBlcnJvcjsKICB9Cn0KCi8vIEpXVCBERUNPREUgVVRJTElUWQpmdW5jdGlvbiBkZWNvZGVKV1QodG9rZW4pIHsKICB0cnkgewogICAgY29uc3QgcGFydHMgPSB0b2tlbi5zcGxpdCgnLicpOwogICAgaWYgKHBhcnRzLmxlbmd0aCAhPT0gMykgcmV0dXJuIG51bGw7CiAgICAKICAgIGNvbnN0IHBheWxvYWQgPSBwYXJ0c1sxXTsKICAgIGNvbnN0IHBhZGRlZFBheWxvYWQgPSBwYXlsb2FkICsgJz0nLnJlcGVhdCgoNCAtIHBheWxvYWQubGVuZ3RoICUgNCkgJSA0KTsKICAgIGNvbnN0IGRlY29kZWRQYXlsb2FkID0gQnVmZmVyLmZyb20ocGFkZGVkUGF5bG9hZCwgJ2Jhc2U2NCcpLnRvU3RyaW5nKCd1dGY4Jyk7CiAgICByZXR1cm4gSlNPTi5wYXJzZShkZWNvZGVkUGF5bG9hZCk7CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ0pXVCBkZWNvZGUgZXJyb3I6JywgZXJyb3IubWVzc2FnZSk7CiAgICByZXR1cm4gbnVsbDsKICB9Cn0KCi8vIEVOSEFOQ0VEIFRPS0VOIFJFRlJFU0ggV0lUSCBMT0NBVElPTiBTVVBQT1JUCmFzeW5jIGZ1bmN0aW9uIGVuaGFuY2VkUmVmcmVzaEFjY2Vzc1Rva2VuKGlkKSB7CiAgdHJ5IHsKICAgIGNvbnN0IGluc3QgPSBpbnN0YWxsYXRpb25zLmdldChpZCk7CiAgICBpZiAoIWluc3QgfHwgIWluc3QucmVmcmVzaFRva2VuKSB7CiAgICAgIGNvbnNvbGUubG9nKGBbUkVGUkVTSF0g4p2MIE5vIHJlZnJlc2ggdG9rZW4gZm9yICR7aWR9YCk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7CiAgICAgIGNsaWVudF9pZDogcHJvY2Vzcy5lbnYuR0hMX0NMSUVOVF9JRCwKICAgICAgY2xpZW50X3NlY3JldDogcHJvY2Vzcy5lbnYuR0hMX0NMSUVOVF9TRUNSRVQsCiAgICAgIGdyYW50X3R5cGU6ICdyZWZyZXNoX3Rva2VuJywKICAgICAgcmVmcmVzaF90b2tlbjogaW5zdC5yZWZyZXNoVG9rZW4sCiAgICAgIHVzZXJfdHlwZTogJ0xvY2F0aW9uJyAvLyBLZWVwIHVzaW5nIExvY2F0aW9uIHVzZXIgdHlwZQogICAgfSk7CgogICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBheGlvcy5wb3N0KCdodHRwczovL3NlcnZpY2VzLmxlYWRjb25uZWN0b3JocS5jb20vb2F1dGgvdG9rZW4nLCBib2R5LCB7CiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnIH0sCiAgICAgIHRpbWVvdXQ6IDE1MDAwCiAgICB9KTsKCiAgICAvLyBVcGRhdGUgQ29tcGFueSB0b2tlbgogICAgaW5zdC5hY2Nlc3NUb2tlbiA9IGRhdGEuYWNjZXNzX3Rva2VuOwogICAgaW5zdC5yZWZyZXNoVG9rZW4gPSBkYXRhLnJlZnJlc2hfdG9rZW47CiAgICBpbnN0LmV4cGlyZXNJbiA9IGRhdGEuZXhwaXJlc19pbjsKICAgIGluc3QuZXhwaXJlc0F0ID0gRGF0ZS5ub3coKSArIGRhdGEuZXhwaXJlc19pbiAqIDEwMDA7CiAgICBpbnN0LnRva2VuU3RhdHVzID0gJ3ZhbGlkJzsKICAgIGluc3QubGFzdFJlZnJlc2ggPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7CgogICAgLy8gQ2xlYXIgbG9jYXRpb24gdG9rZW4gdG8gZm9yY2UgbmV3IGNvbnZlcnNpb24gb24gbmV4dCByZXF1ZXN0CiAgICBpZiAobG9jYXRpb25Ub2tlbnMuaGFzKGlkKSkgewogICAgICBjb25zb2xlLmxvZygnW1JFRlJFU0hdIPCflIQgQ2xlYXJpbmcgY2FjaGVkIExvY2F0aW9uIHRva2VuIHRvIGZvcmNlIHJlY29udmVyc2lvbicpOwogICAgICBsb2NhdGlvblRva2Vucy5kZWxldGUoaWQpOwogICAgfQoKICAgIGNvbnNvbGUubG9nKGBbUkVGUkVTSF0g4pyFIFJlZnJlc2hlZCB0b2tlbnMgZm9yICR7aWR9YCk7CiAgICBzY2hlZHVsZVJlZnJlc2hTbWFydChpZCk7CiAgICByZXR1cm4gdHJ1ZTsKCiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoYFtSRUZSRVNIXSDinYwgRmFpbGVkIGZvciAke2lkfTpgLCBlcnJvci5yZXNwb25zZT8uZGF0YSB8fCBlcnJvci5tZXNzYWdlKTsKICAgIGNvbnN0IGluc3QgPSBpbnN0YWxsYXRpb25zLmdldChpZCk7CiAgICBpZiAoaW5zdCkgewogICAgICBpbnN0LnRva2VuU3RhdHVzID0gJ3JlZnJlc2hfZmFpbGVkJzsKICAgIH0KICAgIHJldHVybiBmYWxzZTsKICB9Cn0KCi8vIFNNQVJUIFRPS0VOIFJFRlJFU0ggU0NIRURVTElORwpmdW5jdGlvbiBzY2hlZHVsZVJlZnJlc2hTbWFydChpZCkgewogIGNvbnN0IGluc3QgPSBpbnN0YWxsYXRpb25zLmdldChpZCk7CiAgaWYgKCFpbnN0KSByZXR1cm47CgogIC8vIENsZWFyIGV4aXN0aW5nIHRpbWVvdXRzCiAgaWYgKGluc3QucmVmcmVzaFRpbWVvdXQpIHsKICAgIGNsZWFyVGltZW91dChpbnN0LnJlZnJlc2hUaW1lb3V0KTsKICB9CgogIC8vIFNjaGVkdWxlIHJlZnJlc2ggYXQgODAlIG9mIHRva2VuIGxpZmV0aW1lICh3aXRoIDEwIG1pbnV0ZSBtaW5pbXVtIHBhZGRpbmcpCiAgY29uc3QgbGlmZXRpbWUgPSBpbnN0LmV4cGlyZXNJbiAqIDEwMDA7CiAgY29uc3QgcmVmcmVzaFRpbWUgPSBNYXRoLm1heChsaWZldGltZSAqIDAuOCwgbGlmZXRpbWUgLSAoMTAgKiA2MCAqIDEwMDApKTsKCiAgaW5zdC5yZWZyZXNoVGltZW91dCA9IHNldFRpbWVvdXQoYXN5bmMgKCkgPT4gewogICAgY29uc29sZS5sb2coYFtTQ0hFRFVMRV0g8J+UhCBBdXRvLXJlZnJlc2hpbmcgdG9rZW4gZm9yICR7aWR9YCk7CiAgICBhd2FpdCBlbmhhbmNlZFJlZnJlc2hBY2Nlc3NUb2tlbihpZCk7CiAgfSwgcmVmcmVzaFRpbWUpOwoKICBjb25zb2xlLmxvZyhgW1NDSEVEVUxFXSDij7AgVG9rZW4gcmVmcmVzaCBzY2hlZHVsZWQgZm9yICR7aWR9IGluICR7TWF0aC5mbG9vcihyZWZyZXNoVGltZSAvIDEwMDAgLyA2MCl9IG1pbnV0ZXNgKTsKfQoKLy8gT0F1dGggdG9rZW4gZXhjaGFuZ2Ugd2l0aCBMb2NhdGlvbiB1c2VyIHR5cGUKYXN5bmMgZnVuY3Rpb24gZXhjaGFuZ2VDb2RlKGNvZGUsIHJlZGlyZWN0VXJpKSB7CiAgY29uc3QgYm9keSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoewogICAgY2xpZW50X2lkOiBwcm9jZXNzLmVudi5HSExfQ0xJRU5UX0lELAogICAgY2xpZW50X3NlY3JldDogcHJvY2Vzcy5lbnYuR0hMX0NMSUVOVF9TRUNSRVQsCiAgICBncmFudF90eXBlOiAnYXV0aG9yaXphdGlvbl9jb2RlJywKICAgIGNvZGUsCiAgICB1c2VyX3R5cGU6ICdMb2NhdGlvbicsIC8vIENSSVRJQ0FMOiBMb2NhdGlvbiB1c2VyIHR5cGUgcGFyYW1ldGVyIGZyb20gb2ZmaWNpYWwgZGVtbwogICAgcmVkaXJlY3RfdXJpOiByZWRpcmVjdFVyaQogIH0pOwogIAogIGNvbnNvbGUubG9nKCdbT0FVVEhdIFRva2VuIGV4Y2hhbmdlIHVzaW5nIHVzZXJfdHlwZTogTG9jYXRpb24gcGFyYW1ldGVyJyk7CiAgCiAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBheGlvcy5wb3N0KCdodHRwczovL3NlcnZpY2VzLmxlYWRjb25uZWN0b3JocS5jb20vb2F1dGgvdG9rZW4nLCBib2R5LCB7CiAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyB9LAogICAgdGltZW91dDogMTUwMDAKICB9KTsKICByZXR1cm4gZGF0YTsKfQoKZnVuY3Rpb24gc3RvcmVJbnN0YWxsKHRva2VuRGF0YSkgewogIGNvbnN0IGlkID0gYGluc3RhbGxfJHtEYXRlLm5vdygpfWA7CiAgCiAgLy8gRGVjb2RlIEpXVCB0byBnZXQgYXV0aCBjbGFzcyBhbmQgbG9jYXRpb24gaW5mbwogIGNvbnN0IGp3dCA9IGRlY29kZUpXVCh0b2tlbkRhdGEuYWNjZXNzX3Rva2VuKTsKICBjb25zdCBhdXRoQ2xhc3MgPSBqd3Q/LmF1dGhDbGFzcyB8fCAndW5rbm93bic7CiAgY29uc3QgbG9jYXRpb25JZCA9IGp3dD8uYXV0aENsYXNzSWQgfHwgdG9rZW5EYXRhLmxvY2F0aW9uSWQgfHwgJ1dBdms4N1JtVzlyQlNESkhlT3BIJzsKICAKICBpbnN0YWxsYXRpb25zLnNldChpZCwgewogICAgaWQsCiAgICBhY2Nlc3NUb2tlbjogdG9rZW5EYXRhLmFjY2Vzc190b2tlbiwKICAgIHJlZnJlc2hUb2tlbjogdG9rZW5EYXRhLnJlZnJlc2hfdG9rZW4sCiAgICBleHBpcmVzSW46IHRva2VuRGF0YS5leHBpcmVzX2luLAogICAgZXhwaXJlc0F0OiBEYXRlLm5vdygpICsgdG9rZW5EYXRhLmV4cGlyZXNfaW4gKiAxMDAwLAogICAgbG9jYXRpb25JZDogYXV0aENsYXNzID09PSAnTG9jYXRpb24nID8gbG9jYXRpb25JZCA6ICdXQXZrODdSbVc5ckJTREpIZU9wSCcsCiAgICBzY29wZXM6IHRva2VuRGF0YS5zY29wZSB8fCAnJywKICAgIHRva2VuU3RhdHVzOiAndmFsaWQnLAogICAgYXV0aENsYXNzOiBhdXRoQ2xhc3MsCiAgICBtZXRob2Q6ICd1c2VyX3R5cGUgTG9jYXRpb24gcGFyYW1ldGVyICsgYXV0b21hdGljIGNvbnZlcnNpb24nLAogICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksCiAgICBsYXN0QWN0aXZpdHk6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKQogIH0pOwogIAogIHNjaGVkdWxlUmVmcmVzaFNtYXJ0KGlkKTsKICBjb25zb2xlLmxvZyhgW05FVyBJTlNUQUxMXSAke2lkfSBzdG9yZWQgd2l0aCBhdXRoIGNsYXNzOiAke2F1dGhDbGFzc31gKTsKICAKICAvLyBMb2cgdG9rZW4gY29udmVyc2lvbiBjYXBhYmlsaXR5CiAgaWYgKGF1dGhDbGFzcyA9PT0gJ0NvbXBhbnknKSB7CiAgICBjb25zb2xlLmxvZyhgW05FVyBJTlNUQUxMXSBDb21wYW55IHRva2VuIGRldGVjdGVkIC0gTG9jYXRpb24gY29udmVyc2lvbiBhdmFpbGFibGVgKTsKICB9IGVsc2UgaWYgKGF1dGhDbGFzcyA9PT0gJ0xvY2F0aW9uJykgewogICAgY29uc29sZS5sb2coYFtORVcgSU5TVEFMTF0gTG9jYXRpb24gdG9rZW4gZGV0ZWN0ZWQgLSBkaXJlY3QgdXNhZ2UgYXZhaWxhYmxlYCk7CiAgfQogIAogIHJldHVybiBpZDsKfQoKLy8gT0FVVEggQ0FMTEJBQ0sKYXBwLmdldChbJy9vYXV0aC9jYWxsYmFjaycsICcvYXBpL29hdXRoL2NhbGxiYWNrJ10sIGFzeW5jIChyZXEsIHJlcykgPT4gewogIGNvbnNvbGUubG9nKCc9PT0gT0FVVEggQ0FMTEJBQ0sgUkVDRUlWRUQgPT09Jyk7CiAgY29uc29sZS5sb2coJ1F1ZXJ5IHBhcmFtczonLCByZXEucXVlcnkpOwogIAogIGNvbnN0IHsgY29kZSwgZXJyb3IgfSA9IHJlcS5xdWVyeTsKICAKICBpZiAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ09BdXRoIGVycm9yIGZyb20gR0hMOicsIGVycm9yKTsKICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnT0F1dGggZXJyb3InLCBkZXRhaWxzOiBlcnJvciB9KTsKICB9CiAgCiAgaWYgKCFjb2RlKSB7CiAgICBjb25zb2xlLmVycm9yKCdObyBhdXRob3JpemF0aW9uIGNvZGUgcmVjZWl2ZWQnKTsKICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnY29kZSByZXF1aXJlZCcgfSk7CiAgfQogIAogIHRyeSB7CiAgICBjb25zdCByZWRpcmVjdFVyaSA9IHByb2Nlc3MuZW52LkdITF9SRURJUkVDVF9VUkkgfHwgJ2h0dHBzOi8vZGlyLmVuZ2FnZWF1dG9tYXRpb25zLmNvbS9hcGkvb2F1dGgvY2FsbGJhY2snOwogICAgY29uc29sZS5sb2coJ0V4Y2hhbmdpbmcgY29kZSBmb3IgdG9rZW5zIHdpdGggTG9jYXRpb24gdXNlciB0eXBlLi4uJyk7CiAgICAKICAgIGNvbnN0IHRva2VuRGF0YSA9IGF3YWl0IGV4Y2hhbmdlQ29kZShjb2RlLCByZWRpcmVjdFVyaSk7CiAgICBjb25zb2xlLmxvZygnVG9rZW4gZXhjaGFuZ2Ugc3VjY2Vzc2Z1bCcpOwogICAgCiAgICBjb25zdCBpZCA9IHN0b3JlSW5zdGFsbCh0b2tlbkRhdGEpOwogICAgY29uc29sZS5sb2coJ0luc3RhbGxhdGlvbiBzdG9yZWQgd2l0aCBJRDonLCBpZCk7CiAgICAKICAgIC8vIFJlZGlyZWN0IHRvIGZyb250ZW5kCiAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly9saXN0aW5ncy5lbmdhZ2VhdXRvbWF0aW9ucy5jb20vP2luc3RhbGxhdGlvbl9pZD0ke2lkfSZ3ZWxjb21lPXRydWVgOwogICAgY29uc29sZS5sb2coJ1JlZGlyZWN0aW5nIHRvOicsIHVybCk7CiAgICByZXMucmVkaXJlY3QodXJsKTsKICAgIAogIH0gY2F0Y2ggKGUpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ09BdXRoIGVycm9yOicsIGUucmVzcG9uc2U/LmRhdGEgfHwgZS5tZXNzYWdlKTsKICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdPQXV0aCBmYWlsZWQnLCBkZXRhaWxzOiBlLnJlc3BvbnNlPy5kYXRhIHx8IGUubWVzc2FnZSB9KTsKICB9Cn0pOwoKLy8gSU5TVEFMTEFUSU9OUyBFTkRQT0lOVAphcHAuZ2V0KCcvaW5zdGFsbGF0aW9ucycsIChyZXEsIHJlcykgPT4gewogIGNvbnN0IGluc3RhbGxMaXN0ID0gQXJyYXkuZnJvbShpbnN0YWxsYXRpb25zLnZhbHVlcygpKS5tYXAoaW5zdCA9PiAoewogICAgaWQ6IGluc3QuaWQsCiAgICBsb2NhdGlvbl9pZDogaW5zdC5sb2NhdGlvbklkLAogICAgYWN0aXZlOiB0cnVlLAogICAgY3JlYXRlZF9hdDogaW5zdC5jcmVhdGVkQXQsCiAgICB0b2tlbl9zdGF0dXM6IGluc3QudG9rZW5TdGF0dXMsCiAgICBhdXRoX2NsYXNzOiBpbnN0LmF1dGhDbGFzcywKICAgIG1ldGhvZDogaW5zdC5tZXRob2QsCiAgICBzY29wZXM6IGluc3Quc2NvcGVzLAogICAgaGFzX2xvY2F0aW9uX3Rva2VuOiBsb2NhdGlvblRva2Vucy5oYXMoaW5zdC5pZCkKICB9KSk7CiAgCiAgcmVzLmpzb24oewogICAgY291bnQ6IGluc3RhbGxhdGlvbnMuc2l6ZSwKICAgIGluc3RhbGxhdGlvbnM6IGluc3RhbGxMaXN0CiAgfSk7Cn0pOwoKLy8gVE9LRU4gQUNDRVNTIEVORFBPSU5UIChDb21wYW55IHRva2VucykKYXBwLmdldCgnL2FwaS90b2tlbi1hY2Nlc3MvOmlkJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7CiAgdHJ5IHsKICAgIGNvbnN0IGluc3QgPSBpbnN0YWxsYXRpb25zLmdldChyZXEucGFyYW1zLmlkKTsKICAgIGlmICghaW5zdCkgewogICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ0luc3RhbGxhdGlvbiBub3QgZm91bmQnIH0pOwogICAgfQoKICAgIC8vIENoZWNrIHRva2VuIGZyZXNobmVzcwogICAgaWYgKGluc3QuZXhwaXJlc0F0IDw9IERhdGUubm93KCkpIHsKICAgICAgY29uc3QgcmVmcmVzaGVkID0gYXdhaXQgZW5oYW5jZWRSZWZyZXNoQWNjZXNzVG9rZW4ocmVxLnBhcmFtcy5pZCk7CiAgICAgIGlmICghcmVmcmVzaGVkKSB7CiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdUb2tlbiBleHBpcmVkIGFuZCByZWZyZXNoIGZhaWxlZCcgfSk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBqd3QgPSBkZWNvZGVKV1QoaW5zdC5hY2Nlc3NUb2tlbik7CiAgICAKICAgIHJlcy5qc29uKHsKICAgICAgYWNjZXNzX3Rva2VuOiBpbnN0LmFjY2Vzc1Rva2VuLAogICAgICB0b2tlbl90eXBlOiAnQmVhcmVyJywKICAgICAgZXhwaXJlc19pbjogTWF0aC5mbG9vcigoaW5zdC5leHBpcmVzQXQgLSBEYXRlLm5vdygpKSAvIDEwMDApLAogICAgICBzY29wZTogaW5zdC5zY29wZXMsCiAgICAgIGxvY2F0aW9uX2lkOiBpbnN0LmxvY2F0aW9uSWQsCiAgICAgIGF1dGhfY2xhc3M6IGp3dD8uYXV0aENsYXNzIHx8ICd1bmtub3duJwogICAgfSk7CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1Rva2VuIGFjY2VzcyBlcnJvcjonLCBlcnJvci5tZXNzYWdlKTsKICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdUb2tlbiBhY2Nlc3MgZmFpbGVkJywgZGV0YWlsczogZXJyb3IubWVzc2FnZSB9KTsKICB9Cn0pOwoKLy8gTE9DQVRJT04gVE9LRU4gQUNDRVNTIEVORFBPSU5UIC0gTkVXCmFwcC5nZXQoJy9hcGkvbG9jYXRpb24tdG9rZW4vOmlkJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7CiAgdHJ5IHsKICAgIGNvbnNvbGUubG9nKCdbTE9DQVRJT04tRU5EUE9JTlRdIFJlcXVlc3QgZm9yIExvY2F0aW9uIHRva2VuOicsIHJlcS5wYXJhbXMuaWQpOwogICAgCiAgICBjb25zdCBsb2NhdGlvblRva2VuID0gYXdhaXQgZ2V0TG9jYXRpb25Ub2tlbihyZXEucGFyYW1zLmlkKTsKICAgIGNvbnN0IGxvY2F0aW9uVG9rZW5EYXRhID0gbG9jYXRpb25Ub2tlbnMuZ2V0KHJlcS5wYXJhbXMuaWQpOwogICAgCiAgICByZXMuanNvbih7CiAgICAgIGFjY2Vzc190b2tlbjogbG9jYXRpb25Ub2tlbiwKICAgICAgdG9rZW5fdHlwZTogJ0JlYXJlcicsCiAgICAgIGV4cGlyZXNfaW46IE1hdGguZmxvb3IoKGxvY2F0aW9uVG9rZW5EYXRhLmV4cGlyZXNBdCAtIERhdGUubm93KCkpIC8gMTAwMCksCiAgICAgIGxvY2F0aW9uX2lkOiBsb2NhdGlvblRva2VuRGF0YS5sb2NhdGlvbklkLAogICAgICBhdXRoX2NsYXNzOiAnTG9jYXRpb24nLAogICAgICBjcmVhdGVkX2F0OiBsb2NhdGlvblRva2VuRGF0YS5jcmVhdGVkQXQKICAgIH0pOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdMb2NhdGlvbiB0b2tlbiBhY2Nlc3MgZXJyb3I6JywgZXJyb3IubWVzc2FnZSk7CiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IAogICAgICBlcnJvcjogJ0xvY2F0aW9uIHRva2VuIGFjY2VzcyBmYWlsZWQnLCAKICAgICAgZGV0YWlsczogZXJyb3IubWVzc2FnZSwKICAgICAgaGludDogJ0NvbXBhbnkgdG9rZW4gbWF5IG5vdCBoYXZlIG9hdXRoLndyaXRlIHNjb3BlIG9yIGxvY2F0aW9uIGNvbnZlcnNpb24gZmFpbGVkJwogICAgfSk7CiAgfQp9KTsKCi8vIEVOSEFOQ0VEIE1FRElBIFVQTE9BRCBXSVRIIEFVVE9NQVRJQyBMT0NBVElPTiBUT0tFTiBDT05WRVJTSU9OCmFwcC5wb3N0KCcvYXBpL21lZGlhL3VwbG9hZCcsIHVwbG9hZC5zaW5nbGUoJ2ZpbGUnKSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7CiAgY29uc29sZS5sb2coJz09PSBFTkhBTkNFRCBNRURJQSBVUExPQUQgV0lUSCBMT0NBVElPTiBUT0tFTiA9PT0nKTsKICAKICB0cnkgewogICAgY29uc3QgeyBpbnN0YWxsYXRpb25faWQgfSA9IHJlcS5ib2R5OwogICAgCiAgICBpZiAoIWluc3RhbGxhdGlvbl9pZCkgewogICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdpbnN0YWxsYXRpb25faWQgcmVxdWlyZWQnIH0pOwogICAgfQogICAgCiAgICBpZiAoIXJlcS5maWxlKSB7CiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ2ZpbGUgcmVxdWlyZWQnIH0pOwogICAgfQogICAgCiAgICBjb25zb2xlLmxvZyhgW01FRElBXSBVcGxvYWRpbmcgZmlsZTogJHtyZXEuZmlsZS5vcmlnaW5hbG5hbWV9IHdpdGggYXV0b21hdGljIExvY2F0aW9uIHRva2VuIGNvbnZlcnNpb25gKTsKICAgIAogICAgLy8gR2V0IExvY2F0aW9uIHRva2VuIGZvciBtZWRpYSB1cGxvYWQKICAgIGNvbnN0IGxvY2F0aW9uVG9rZW4gPSBhd2FpdCBnZXRMb2NhdGlvblRva2VuKGluc3RhbGxhdGlvbl9pZCk7CiAgICBjb25zdCBsb2NhdGlvblRva2VuRGF0YSA9IGxvY2F0aW9uVG9rZW5zLmdldChpbnN0YWxsYXRpb25faWQpOwogICAgCiAgICAvLyBDcmVhdGUgZm9ybSBkYXRhIGZvciBHb0hpZ2hMZXZlbCBBUEkKICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBmcy5jcmVhdGVSZWFkU3RyZWFtKHJlcS5maWxlLnBhdGgpLCB7CiAgICAgIGZpbGVuYW1lOiByZXEuZmlsZS5vcmlnaW5hbG5hbWUsCiAgICAgIGNvbnRlbnRUeXBlOiByZXEuZmlsZS5taW1ldHlwZQogICAgfSk7CiAgICAKICAgIC8vIFVwbG9hZCB1c2luZyBMb2NhdGlvbiB0b2tlbgogICAgY29uc29sZS5sb2coYFtNRURJQV0gVXNpbmcgTG9jYXRpb24gdG9rZW4gZm9yIHVwbG9hZCB0byBsb2NhdGlvbjogJHtsb2NhdGlvblRva2VuRGF0YS5sb2NhdGlvbklkfWApOwogICAgCiAgICBjb25zdCB1cGxvYWRSZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3QoCiAgICAgICdodHRwczovL3NlcnZpY2VzLmxlYWRjb25uZWN0b3JocS5jb20vbWVkaWFzL3VwbG9hZC1maWxlJywKICAgICAgZm9ybURhdGEsCiAgICAgIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtsb2NhdGlvblRva2VufWAsCiAgICAgICAgICAnVmVyc2lvbic6ICcyMDIxLTA3LTI4JywKICAgICAgICAgIC4uLmZvcm1EYXRhLmdldEhlYWRlcnMoKQogICAgICAgIH0sCiAgICAgICAgbWF4Qm9keUxlbmd0aDogSW5maW5pdHksCiAgICAgICAgdGltZW91dDogMzAwMDAKICAgICAgfQogICAgKTsKICAgIAogICAgLy8gQ2xlYW4gdXAgdXBsb2FkZWQgZmlsZQogICAgZnMudW5saW5rU3luYyhyZXEuZmlsZS5wYXRoKTsKICAgIAogICAgY29uc29sZS5sb2coJ1tNRURJQV0g4pyFIFVwbG9hZCBzdWNjZXNzZnVsIHdpdGggTG9jYXRpb24gdG9rZW4nKTsKICAgIHJlcy5qc29uKHsKICAgICAgc3VjY2VzczogdHJ1ZSwKICAgICAgbWVzc2FnZTogJ0ZpbGUgdXBsb2FkZWQgc3VjY2Vzc2Z1bGx5IHdpdGggTG9jYXRpb24gdG9rZW4nLAogICAgICBkYXRhOiB1cGxvYWRSZXNwb25zZS5kYXRhLAogICAgICB0b2tlblR5cGU6ICdMb2NhdGlvbicsCiAgICAgIGxvY2F0aW9uSWQ6IGxvY2F0aW9uVG9rZW5EYXRhLmxvY2F0aW9uSWQsCiAgICAgIGNvbnZlcnNpb25Vc2VkOiB0cnVlCiAgICB9KTsKICAgIAogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAvLyBDbGVhbiB1cCBmaWxlIG9uIGVycm9yCiAgICBpZiAocmVxLmZpbGUgJiYgZnMuZXhpc3RzU3luYyhyZXEuZmlsZS5wYXRoKSkgewogICAgICBmcy51bmxpbmtTeW5jKHJlcS5maWxlLnBhdGgpOwogICAgfQogICAgCiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvci5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSB8fCBlcnJvci5tZXNzYWdlOwogICAgY29uc3Qgc3RhdHVzQ29kZSA9IGVycm9yLnJlc3BvbnNlPy5zdGF0dXMgfHwgNTAwOwogICAgCiAgICBjb25zb2xlLmVycm9yKCdbTUVESUFdIOKdjCBVcGxvYWQgZmFpbGVkOicsIGVycm9yTWVzc2FnZSk7CiAgICBjb25zb2xlLmVycm9yKCdbTUVESUFdIFN0YXR1czonLCBzdGF0dXNDb2RlKTsKICAgIAogICAgcmVzLnN0YXR1cyhzdGF0dXNDb2RlKS5qc29uKHsKICAgICAgc3VjY2VzczogZmFsc2UsCiAgICAgIGVycm9yOiAnTWVkaWEgdXBsb2FkIGZhaWxlZCcsCiAgICAgIGRldGFpbHM6IGVycm9yTWVzc2FnZSwKICAgICAgdG9rZW5UeXBlOiAnTG9jYXRpb24nLAogICAgICBoaW50OiBzdGF0dXNDb2RlID09PSA0MDEgPyAnTG9jYXRpb24gdG9rZW4gbWF5IGhhdmUgZXhwaXJlZCBvciBpbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMnIDogJ0NoZWNrIGZpbGUgZm9ybWF0IGFuZCBzaXplJwogICAgfSk7CiAgfQp9KTsKCi8vIE9BVVRIIFNUQVRVUwphcHAuZ2V0KCcvYXBpL29hdXRoL3N0YXR1cycsIChyZXEsIHJlcykgPT4gewogIGNvbnN0IGluc3QgPSBpbnN0YWxsYXRpb25zLmdldChyZXEucXVlcnkuaW5zdGFsbGF0aW9uX2lkKTsKICBpZiAoIWluc3QpIHJldHVybiByZXMuanNvbih7IGF1dGhlbnRpY2F0ZWQ6IGZhbHNlIH0pOwogIAogIGNvbnN0IGhhc0xvY2F0aW9uVG9rZW4gPSBsb2NhdGlvblRva2Vucy5oYXMocmVxLnF1ZXJ5Lmluc3RhbGxhdGlvbl9pZCk7CiAgCiAgcmVzLmpzb24oeyAKICAgIGF1dGhlbnRpY2F0ZWQ6IHRydWUsIAogICAgdG9rZW5TdGF0dXM6IGluc3QudG9rZW5TdGF0dXMsIAogICAgbG9jYXRpb25JZDogaW5zdC5sb2NhdGlvbklkLAogICAgYXV0aENsYXNzOiBpbnN0LmF1dGhDbGFzcywKICAgIGhhc0xvY2F0aW9uVG9rZW46IGhhc0xvY2F0aW9uVG9rZW4sCiAgICBjb252ZXJzaW9uQXZhaWxhYmxlOiBpbnN0LmF1dGhDbGFzcyA9PT0gJ0NvbXBhbnknCiAgfSk7Cn0pOwoKLy8gVE9LRU4gSEVBTFRIIEVORFBPSU5UCmFwcC5nZXQoJy9hcGkvdG9rZW4taGVhbHRoLzppZCcsIGFzeW5jIChyZXEsIHJlcykgPT4gewogIGNvbnN0IGluc3QgPSBpbnN0YWxsYXRpb25zLmdldChyZXEucGFyYW1zLmlkKTsKICBpZiAoIWluc3QpIHsKICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnSW5zdGFsbGF0aW9uIG5vdCBmb3VuZCcgfSk7CiAgfQoKICBjb25zdCB0aW1lVW50aWxFeHBpcnkgPSBNYXRoLmZsb29yKChpbnN0LmV4cGlyZXNBdCAtIERhdGUubm93KCkpIC8gMTAwMCAvIDYwKTsKICBjb25zdCBoYXNMb2NhdGlvblRva2VuID0gbG9jYXRpb25Ub2tlbnMuaGFzKHJlcS5wYXJhbXMuaWQpOwogIAogIGxldCBsb2NhdGlvblRva2VuSW5mbyA9IG51bGw7CiAgaWYgKGhhc0xvY2F0aW9uVG9rZW4pIHsKICAgIGNvbnN0IGxvY1Rva2VuID0gbG9jYXRpb25Ub2tlbnMuZ2V0KHJlcS5wYXJhbXMuaWQpOwogICAgbG9jYXRpb25Ub2tlbkluZm8gPSB7CiAgICAgIGV4cGlyZXNJbjogTWF0aC5mbG9vcigobG9jVG9rZW4uZXhwaXJlc0F0IC0gRGF0ZS5ub3coKSkgLyAxMDAwIC8gNjApLAogICAgICBsb2NhdGlvbklkOiBsb2NUb2tlbi5sb2NhdGlvbklkLAogICAgICBjcmVhdGVkQXQ6IGxvY1Rva2VuLmNyZWF0ZWRBdAogICAgfTsKICB9CiAgCiAgcmVzLmpzb24oewogICAgaW5zdGFsbGF0aW9uSWQ6IHJlcS5wYXJhbXMuaWQsCiAgICB0b2tlblN0YXR1czogaW5zdC50b2tlblN0YXR1cywKICAgIGF1dGhDbGFzczogaW5zdC5hdXRoQ2xhc3MsCiAgICB0aW1lVW50aWxFeHBpcnk6IHRpbWVVbnRpbEV4cGlyeSwKICAgIGxvY2F0aW9uSWQ6IGluc3QubG9jYXRpb25JZCwKICAgIGhhc0xvY2F0aW9uVG9rZW46IGhhc0xvY2F0aW9uVG9rZW4sCiAgICBsb2NhdGlvblRva2VuSW5mbzogbG9jYXRpb25Ub2tlbkluZm8sCiAgICBsYXN0UmVmcmVzaDogaW5zdC5sYXN0UmVmcmVzaCB8fCAnbmV2ZXInCiAgfSk7Cn0pOwoKLy8gTUFOVUFMIExPQ0FUSU9OIFRPS0VOIENPTlZFUlNJT04gRU5EUE9JTlQKYXBwLnBvc3QoJy9hcGkvY29udmVydC10by1sb2NhdGlvbi86aWQnLCBhc3luYyAocmVxLCByZXMpID0+IHsKICB0cnkgewogICAgY29uc29sZS5sb2coJ1tNQU5VQUwtQ09OVkVSVF0gTWFudWFsIExvY2F0aW9uIHRva2VuIGNvbnZlcnNpb24gcmVxdWVzdGVkIGZvcjonLCByZXEucGFyYW1zLmlkKTsKICAgIAogICAgY29uc3QgbG9jYXRpb25Ub2tlbiA9IGF3YWl0IGdldExvY2F0aW9uVG9rZW4ocmVxLnBhcmFtcy5pZCk7CiAgICBjb25zdCBsb2NhdGlvblRva2VuRGF0YSA9IGxvY2F0aW9uVG9rZW5zLmdldChyZXEucGFyYW1zLmlkKTsKICAgIAogICAgcmVzLmpzb24oewogICAgICBzdWNjZXNzOiB0cnVlLAogICAgICBtZXNzYWdlOiAnTG9jYXRpb24gdG9rZW4gY29udmVyc2lvbiBzdWNjZXNzZnVsJywKICAgICAgbG9jYXRpb25JZDogbG9jYXRpb25Ub2tlbkRhdGEubG9jYXRpb25JZCwKICAgICAgZXhwaXJlc0luOiBNYXRoLmZsb29yKChsb2NhdGlvblRva2VuRGF0YS5leHBpcmVzQXQgLSBEYXRlLm5vdygpKSAvIDEwMDApLAogICAgICBjcmVhdGVkQXQ6IGxvY2F0aW9uVG9rZW5EYXRhLmNyZWF0ZWRBdAogICAgfSk7CiAgICAKICB9IGNhdGNoIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignW01BTlVBTC1DT05WRVJUXSDinYwgTWFudWFsIGNvbnZlcnNpb24gZmFpbGVkOicsIGVycm9yLm1lc3NhZ2UpOwogICAgcmVzLnN0YXR1cyg1MDApLmpzb24oewogICAgICBzdWNjZXNzOiBmYWxzZSwKICAgICAgZXJyb3I6ICdMb2NhdGlvbiB0b2tlbiBjb252ZXJzaW9uIGZhaWxlZCcsCiAgICAgIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UKICAgIH0pOwogIH0KfSk7CgovLyBTdGFydCBzZXJ2ZXIKYXBwLmxpc3RlbihQT1JULCAoKSA9PiB7CiAgY29uc29sZS5sb2coYPCfmoAgRW5oYW5jZWQgT0F1dGggQmFja2VuZCB2MTAuMC4wIHJ1bm5pbmcgb24gcG9ydCAke1BPUlR9YCk7CiAgY29uc29sZS5sb2coJ+KchSBMb2NhdGlvbiB0b2tlbiBjb252ZXJzaW9uIGVuYWJsZWQnKTsKICBjb25zb2xlLmxvZygn4pyFIEF1dG9tYXRpYyBDb21wYW55IOKGkiBMb2NhdGlvbiB0b2tlbiBjb252ZXJzaW9uIGZvciBtZWRpYSBBUElzJyk7CiAgY29uc29sZS5sb2coJ+KchSBFbmhhbmNlZCB0b2tlbiBtYW5hZ2VtZW50IHdpdGggZHVhbCB0b2tlbiBzdG9yYWdlJyk7CiAgY29uc29sZS5sb2coJycpOwogIGNvbnNvbGUubG9nKCfwn5OLIE5FVyBFTkRQT0lOVFM6Jyk7CiAgY29uc29sZS5sb2coJ+KAoiBHRVQgL2FwaS9sb2NhdGlvbi10b2tlbi86aWQgLSBHZXQgTG9jYXRpb24gdG9rZW4gZm9yIGluc3RhbGxhdGlvbicpOwogIGNvbnNvbGUubG9nKCfigKIgUE9TVCAvYXBpL2NvbnZlcnQtdG8tbG9jYXRpb24vOmlkIC0gTWFudWFsIExvY2F0aW9uIHRva2VuIGNvbnZlcnNpb24nKTsKICBjb25zb2xlLmxvZygn4oCiIFBPU1QgL2FwaS9tZWRpYS91cGxvYWQgLSBFbmhhbmNlZCBtZWRpYSB1cGxvYWQgd2l0aCBMb2NhdGlvbiB0b2tlbnMnKTsKICBjb25zb2xlLmxvZygnJyk7CiAgY29uc29sZS5sb2coJ/CflIQgVG9rZW4gQ29udmVyc2lvbiBGbG93OicpOwogIGNvbnNvbGUubG9nKCcxLiBDb21wYW55IHRva2VuIHJlY2VpdmVkIGZyb20gT0F1dGgnKTsKICBjb25zb2xlLmxvZygnMi4gTG9jYXRpb24gdG9rZW4gZ2VuZXJhdGVkIG9uIGZpcnN0IG1lZGlhIHVwbG9hZCcpOwogIGNvbnNvbGUubG9nKCczLiBMb2NhdGlvbiB0b2tlbiBjYWNoZWQgZm9yIHN1YnNlcXVlbnQgcmVxdWVzdHMnKTsKICBjb25zb2xlLmxvZygnNC4gQXV0b21hdGljIHJlY29udmVyc2lvbiBhZnRlciB0b2tlbiByZWZyZXNoJyk7Cn0pOw==",
  "version": "10.0.0-location-conversion"
}