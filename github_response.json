{
  "name": "index.js",
  "path": "index.js",
  "sha": "146d989c9a51f4e4c37a2f52aa1a2b31208a3d29",
  "size": 24929,
  "url": "https://api.github.com/repos/EngageAutomations/oauth-backend/contents/index.js?ref=main",
  "html_url": "https://github.com/EngageAutomations/oauth-backend/blob/main/index.js",
  "git_url": "https://api.github.com/repos/EngageAutomations/oauth-backend/git/blobs/146d989c9a51f4e4c37a2f52aa1a2b31208a3d29",
  "download_url": "https://raw.githubusercontent.com/EngageAutomations/oauth-backend/main/index.js",
  "type": "file",
  "content": "Ly8gT0F1dGggQmFja2VuZCBGaXggLSBBZGQgbWlzc2luZyBlbmRwb2ludHMg\nZm9yIGluc3RhbGxhdGlvbiB0cmFja2luZwovLyBUaGlzIGZpbGUgYWRkcyB0\naGUgbWlzc2luZyAvaW5zdGFsbGF0aW9ucyBlbmRwb2ludCBhbmQgZGVidWdn\naW5nCgpjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpOwpjb25z\ndCBjb3JzID0gcmVxdWlyZSgnY29ycycpOwpjb25zdCBheGlvcyA9IHJlcXVp\ncmUoJ2F4aW9zJyk7CmNvbnN0IG11bHRlciA9IHJlcXVpcmUoJ211bHRlcicp\nOwpjb25zdCBGb3JtRGF0YSA9IHJlcXVpcmUoJ2Zvcm0tZGF0YScpOwpjb25z\ndCBmcyA9IHJlcXVpcmUoJ2ZzJyk7CgovLyBDb25maWd1cmUgbXVsdGVyIGZv\nciBmaWxlIHVwbG9hZHMKY29uc3QgdXBsb2FkID0gbXVsdGVyKHsgCiAgZGVz\ndDogJ3VwbG9hZHMvJywKICBsaW1pdHM6IHsgZmlsZVNpemU6IDI1ICogMTAy\nNCAqIDEwMjQgfSAvLyAyNU1CIGxpbWl0Cn0pOwoKY29uc3QgYXBwID0gZXhw\ncmVzcygpOwpjb25zdCBwb3J0ID0gcHJvY2Vzcy5lbnYuUE9SVCB8fCAzMDAw\nOwoKLy8gTWlkZGxld2FyZQphcHAudXNlKGNvcnMoKSk7CmFwcC51c2UoZXhw\ncmVzcy5qc29uKCkpOwoKLy8gSW4tbWVtb3J5IGluc3RhbGwgc3RvcmUKY29u\nc3QgaW5zdGFsbGF0aW9ucyA9IG5ldyBNYXAoKTsKCi8vIEN1c3RvbWVyIHN1\ncHBvcnQgZGF0YSBzdG9yZQpjb25zdCBzdXBwb3J0VGlja2V0cyA9IG5ldyBN\nYXAoKTsKY29uc3Qgc3VwcG9ydFNlc3Npb25zID0gbmV3IE1hcCgpOwpjb25z\ndCBzdXBwb3J0TWV0cmljcyA9IHsKICB0b3RhbFRpY2tldHM6IDAsCiAgcmVz\nb2x2ZWRUaWNrZXRzOiAwLAogIGF2ZXJhZ2VSZXNwb25zZVRpbWU6IDAsCiAg\nY3VzdG9tZXJTYXRpc2ZhY3Rpb246IDAKfTsKCi8vIEFkZCBwcmUtc2VlZGVk\nIGluc3RhbGxhdGlvbiBpZiBlbnYgdmFycyBleGlzdAppZiAocHJvY2Vzcy5l\nbnYuR0hMX0FDQ0VTU19UT0tFTikgewogIGluc3RhbGxhdGlvbnMuc2V0KCdp\nbnN0YWxsX3NlZWQnLCB7CiAgICBpZDogJ2luc3RhbGxfc2VlZCcsCiAgICBh\nY2Nlc3NUb2tlbjogcHJvY2Vzcy5lbnYuR0hMX0FDQ0VTU19UT0tFTiwKICAg\nIHJlZnJlc2hUb2tlbjogcHJvY2Vzcy5lbnYuR0hMX1JFRlJFU0hfVE9LRU4g\nfHwgbnVsbCwKICAgIGV4cGlyZXNJbjogODYzOTksCiAgICBleHBpcmVzQXQ6\nIERhdGUubm93KCkgKyA4NjM5OSAqIDEwMDAsCiAgICBsb2NhdGlvbklkOiBw\ncm9jZXNzLmVudi5HSExfTE9DQVRJT05fSUQgfHwgJ1dBdms4N1JtVzlyQlNE\nSkhlT3BIJywKICAgIHNjb3BlczogcHJvY2Vzcy5lbnYuR0hMX1NDT1BFUyB8\nfCAnbWVkaWFzLndyaXRlIG1lZGlhcy5yZWFkb25seScsCiAgICB0b2tlblN0\nYXR1czogJ3ZhbGlkJywKICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lT\nT1N0cmluZygpCiAgfSk7Cn0KCi8vIFRPS0VOIExJRkVDWUNMRSBIRUxQRVJT\nCmNvbnN0IFBBRERJTkdfTVMgPSA1ICogNjAgKiAxMDAwOwpjb25zdCByZWZy\nZXNoZXJzID0gbmV3IE1hcCgpOwoKYXN5bmMgZnVuY3Rpb24gcmVmcmVzaEFj\nY2Vzc1Rva2VuKGlkKSB7CiAgY29uc3QgaW5zdCA9IGluc3RhbGxhdGlvbnMu\nZ2V0KGlkKTsKICBpZiAoIWluc3QgfHwgIWluc3QucmVmcmVzaFRva2VuKSBy\nZXR1cm47CgogIHRyeSB7CiAgICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJj\naFBhcmFtcyh7CiAgICAgIGNsaWVudF9pZDogcHJvY2Vzcy5lbnYuR0hMX0NM\nSUVOVF9JRCwKICAgICAgY2xpZW50X3NlY3JldDogcHJvY2Vzcy5lbnYuR0hM\nX0NMSUVOVF9TRUNSRVQsCiAgICAgIGdyYW50X3R5cGU6ICdyZWZyZXNoX3Rv\na2VuJywKICAgICAgcmVmcmVzaF90b2tlbjogaW5zdC5yZWZyZXNoVG9rZW4K\nICAgIH0pOwoKICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgYXhpb3MucG9z\ndCgKICAgICAgJ2h0dHBzOi8vc2VydmljZXMubGVhZGNvbm5lY3RvcmhxLmNv\nbS9vYXV0aC90b2tlbicsCiAgICAgIGJvZHksCiAgICAgIHsgaGVhZGVyczog\neyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJs\nZW5jb2RlZCcgfSwgdGltZW91dDogMTUwMDAgfQogICAgKTsKCiAgICBpbnN0\nLmFjY2Vzc1Rva2VuID0gZGF0YS5hY2Nlc3NfdG9rZW47CiAgICBpbnN0LnJl\nZnJlc2hUb2tlbiA9IGRhdGEucmVmcmVzaF90b2tlbiB8fCBpbnN0LnJlZnJl\nc2hUb2tlbjsKICAgIGluc3QuZXhwaXJlc0luID0gZGF0YS5leHBpcmVzX2lu\nOwogICAgaW5zdC5leHBpcmVzQXQgPSBEYXRlLm5vdygpICsgZGF0YS5leHBp\ncmVzX2luICogMTAwMDsKICAgIGluc3QudG9rZW5TdGF0dXMgPSAndmFsaWQn\nOwoKICAgIHNjaGVkdWxlUmVmcmVzaChpZCk7CiAgICBjb25zb2xlLmxvZyhg\nW1JFRlJFU0hdICR7aWR9IOKGkiAkeyhkYXRhLmV4cGlyZXNfaW4gLyAzNjAw\nKS50b0ZpeGVkKDEpfSBoYCk7CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBjb25z\nb2xlLmVycm9yKGBbUkVGUkVTSC1GQUlMXSAke2lkfWAsIGVyci5yZXNwb25z\nZT8uZGF0YSB8fCBlcnIubWVzc2FnZSk7CiAgICBpbnN0LnRva2VuU3RhdHVz\nID0gJ2ludmFsaWQnOwogIH0KfQoKZnVuY3Rpb24gc2NoZWR1bGVSZWZyZXNo\nKGlkKSB7CiAgY2xlYXJUaW1lb3V0KHJlZnJlc2hlcnMuZ2V0KGlkKSk7CiAg\nY29uc3QgaW5zdCA9IGluc3RhbGxhdGlvbnMuZ2V0KGlkKTsKICBpZiAoIWlu\nc3QgfHwgIWluc3QuZXhwaXJlc0F0KSByZXR1cm47CiAgY29uc3QgZGVsYXkg\nPSBNYXRoLm1heChpbnN0LmV4cGlyZXNBdCAtIERhdGUubm93KCkgLSBQQURE\nSU5HX01TLCAwKTsKICBjb25zdCB0ID0gc2V0VGltZW91dCgoKSA9PiByZWZy\nZXNoQWNjZXNzVG9rZW4oaWQpLCBkZWxheSk7CiAgcmVmcmVzaGVycy5zZXQo\naWQsIHQpOwp9Cgphc3luYyBmdW5jdGlvbiBlbnN1cmVGcmVzaFRva2VuKGlk\nKSB7CiAgY29uc3QgaW5zdCA9IGluc3RhbGxhdGlvbnMuZ2V0KGlkKTsKICBp\nZiAoIWluc3QpIHRocm93IG5ldyBFcnJvcignVW5rbm93biBpbnN0YWxsYXRp\nb24nKTsKICBpZiAoIWluc3QuZXhwaXJlc0F0IHx8IGluc3QuZXhwaXJlc0F0\nIC0gRGF0ZS5ub3coKSA8IFBBRERJTkdfTVMpIHsKICAgIGF3YWl0IHJlZnJl\nc2hBY2Nlc3NUb2tlbihpZCk7CiAgfQogIGlmIChpbnN0LnRva2VuU3RhdHVz\nICE9PSAndmFsaWQnKSB0aHJvdyBuZXcgRXJyb3IoJ1Rva2VuIGludmFsaWQn\nKTsKfQoKZnVuY3Rpb24gcmVxdWlyZUluc3RhbGwocmVxLCByZXMpIHsKICBj\nb25zdCBpbnN0YWxsYXRpb25JZCA9IHJlcS5tZXRob2QgPT09ICdHRVQnID8g\ncmVxLnF1ZXJ5Lmluc3RhbGxhdGlvbl9pZCA6IHJlcS5ib2R5Lmluc3RhbGxh\ndGlvbl9pZDsKICBjb25zdCBpbnN0ID0gaW5zdGFsbGF0aW9ucy5nZXQoaW5z\ndGFsbGF0aW9uSWQpOwogIGlmICghaW5zdCB8fCAhaW5zdC5hY2Nlc3NUb2tl\nbikgewogICAgcmVzLnN0YXR1cyg0MDApLmpzb24oeyBzdWNjZXNzOiBmYWxz\nZSwgZXJyb3I6IGBJbnN0YWxsYXRpb24gbm90IGZvdW5kOiAke2luc3RhbGxh\ndGlvbklkfWAgfSk7CiAgICByZXR1cm4gbnVsbDsKICB9CiAgcmV0dXJuIGlu\nc3Q7Cn0KCi8vIEJBU0lDIFJPVVRFUwphcHAuZ2V0KCcvJywgKHJlcSwgcmVz\nKSA9PiB7CiAgY29uc3QgYXV0aGVudGljYXRlZENvdW50ID0gQXJyYXkuZnJv\nbShpbnN0YWxsYXRpb25zLnZhbHVlcygpKS5maWx0ZXIoaW5zdCA9PiBpbnN0\nLnRva2VuU3RhdHVzID09PSAndmFsaWQnKS5sZW5ndGg7CiAgcmVzLmpzb24o\newogICAgc2VydmljZTogIkdvSGlnaExldmVsIE9BdXRoIEJhY2tlbmQiLAog\nICAgdmVyc2lvbjogIjUuMy4wLWNvbXBsZXRlLXdvcmtmbG93IiwKICAgIGlu\nc3RhbGxzOiBpbnN0YWxsYXRpb25zLnNpemUsCiAgICBhdXRoZW50aWNhdGVk\nOiBhdXRoZW50aWNhdGVkQ291bnQsCiAgICBzdGF0dXM6ICJvcGVyYXRpb25h\nbCIsCiAgICBmZWF0dXJlczogWyJvYXV0aCIsICJwcm9kdWN0cyIsICJpbWFn\nZXMiLCAicHJpY2luZyIsICJtZWRpYS11cGxvYWQiXSwKICAgIGRlYnVnOiAi\nY29tcGxldGUgbXVsdGktc3RlcCB3b3JrZmxvdyByZWFkeSIsCiAgICB0czog\nRGF0ZS5ub3coKQogIH0pOwp9KTsKCmFwcC5nZXQoJy9oZWFsdGgnLCAocmVx\nLCByZXMpID0+IHsKICByZXMuanNvbih7IHN0YXR1czogJ29rJywgdHM6IG5l\ndyBEYXRlKCkudG9JU09TdHJpbmcoKSB9KTsKfSk7CgovLyBNSVNTSU5HIElO\nU1RBTExBVElPTlMgRU5EUE9JTlQgLSBUaGlzIHdhcyB0aGUgcHJvYmxlbSEK\nYXBwLmdldCgnL2luc3RhbGxhdGlvbnMnLCAocmVxLCByZXMpID0+IHsKICBj\nb25zdCBpbnN0YWxsTGlzdCA9IEFycmF5LmZyb20oaW5zdGFsbGF0aW9ucy52\nYWx1ZXMoKSkubWFwKGluc3QgPT4gKHsKICAgIGlkOiBpbnN0LmlkLAogICAg\nbG9jYXRpb25JZDogaW5zdC5sb2NhdGlvbklkLAogICAgdG9rZW5TdGF0dXM6\nIGluc3QudG9rZW5TdGF0dXMsCiAgICBjcmVhdGVkQXQ6IGluc3QuY3JlYXRl\nZEF0LAogICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShpbnN0LmV4cGlyZXNBdCku\ndG9JU09TdHJpbmcoKSwKICAgIHNjb3BlczogaW5zdC5zY29wZXMsCiAgICBs\nYXN0QWN0aXZpdHk6IGluc3QubGFzdEFjdGl2aXR5IHx8IGluc3QuY3JlYXRl\nZEF0CiAgfSkpOwogIAogIHJlcy5qc29uKHsKICAgIHRvdGFsOiBpbnN0YWxs\nYXRpb25zLnNpemUsCiAgICBhdXRoZW50aWNhdGVkOiBpbnN0YWxsTGlzdC5m\naWx0ZXIoaW5zdCA9PiBpbnN0LnRva2VuU3RhdHVzID09PSAndmFsaWQnKS5s\nZW5ndGgsCiAgICBpbnN0YWxsYXRpb25zOiBpbnN0YWxsTGlzdCwKICAgIHdl\nYmhvb2tFbmRwb2ludDogJy93ZWJob29rL2FwcC11bmluc3RhbGwnCiAgfSk7\nCn0pOwoKLy8gT0F1dGggdG9rZW4gZXhjaGFuZ2UKYXN5bmMgZnVuY3Rpb24g\nZXhjaGFuZ2VDb2RlKGNvZGUsIHJlZGlyZWN0VXJpKSB7CiAgY29uc3QgYm9k\neSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoewogICAgY2xpZW50X2lkOiBwcm9j\nZXNzLmVudi5HSExfQ0xJRU5UX0lELAogICAgY2xpZW50X3NlY3JldDogcHJv\nY2Vzcy5lbnYuR0hMX0NMSUVOVF9TRUNSRVQsCiAgICBncmFudF90eXBlOiAn\nYXV0aG9yaXphdGlvbl9jb2RlJywKICAgIGNvZGUsCiAgICByZWRpcmVjdF91\ncmk6IHJlZGlyZWN0VXJpCiAgfSk7CiAgY29uc3QgeyBkYXRhIH0gPSBhd2Fp\ndCBheGlvcy5wb3N0KCdodHRwczovL3NlcnZpY2VzLmxlYWRjb25uZWN0b3Jo\ncS5jb20vb2F1dGgvdG9rZW4nLCBib2R5LCB7CiAgICBoZWFkZXJzOiB7ICdD\nb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNv\nZGVkJyB9LAogICAgdGltZW91dDogMTUwMDAKICB9KTsKICByZXR1cm4gZGF0\nYTsKfQoKZnVuY3Rpb24gc3RvcmVJbnN0YWxsKHRva2VuRGF0YSkgewogIGNv\nbnN0IGlkID0gYGluc3RhbGxfJHtEYXRlLm5vdygpfWA7CiAgaW5zdGFsbGF0\naW9ucy5zZXQoaWQsIHsKICAgIGlkLAogICAgYWNjZXNzVG9rZW46IHRva2Vu\nRGF0YS5hY2Nlc3NfdG9rZW4sCiAgICByZWZyZXNoVG9rZW46IHRva2VuRGF0\nYS5yZWZyZXNoX3Rva2VuLAogICAgZXhwaXJlc0luOiB0b2tlbkRhdGEuZXhw\naXJlc19pbiwKICAgIGV4cGlyZXNBdDogRGF0ZS5ub3coKSArIHRva2VuRGF0\nYS5leHBpcmVzX2luICogMTAwMCwKICAgIGxvY2F0aW9uSWQ6IHRva2VuRGF0\nYS5sb2NhdGlvbklkIHx8ICdXQXZrODdSbVc5ckJTREpIZU9wSCcsCiAgICBz\nY29wZXM6IHRva2VuRGF0YS5zY29wZSB8fCAnJywKICAgIHRva2VuU3RhdHVz\nOiAndmFsaWQnLAogICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3Ry\naW5nKCkKICB9KTsKICBzY2hlZHVsZVJlZnJlc2goaWQpOwogIGNvbnNvbGUu\nbG9nKGBbTkVXIElOU1RBTExdICR7aWR9IHN0b3JlZCB3aXRoIGxvY2F0aW9u\nICR7dG9rZW5EYXRhLmxvY2F0aW9uSWQgfHwgJ1dBdms4N1JtVzlyQlNESkhl\nT3BIJ31gKTsKICByZXR1cm4gaWQ7Cn0KCi8vIE9BVVRIIENBTExCQUNLIC0g\nRW5oYW5jZWQgd2l0aCBiZXR0ZXIgbG9nZ2luZwphcHAuZ2V0KFsnL29hdXRo\nL2NhbGxiYWNrJywgJy9hcGkvb2F1dGgvY2FsbGJhY2snXSwgYXN5bmMgKHJl\ncSwgcmVzKSA9PiB7CiAgY29uc29sZS5sb2coJz09PSBPQVVUSCBDQUxMQkFD\nSyBSRUNFSVZFRCA9PT0nKTsKICBjb25zb2xlLmxvZygnUXVlcnkgcGFyYW1z\nOicsIHJlcS5xdWVyeSk7CiAgY29uc29sZS5sb2coJ0hlYWRlcnM6JywgcmVx\nLmhlYWRlcnMpOwogIAogIGNvbnN0IHsgY29kZSwgZXJyb3IsIHN0YXRlIH0g\nPSByZXEucXVlcnk7CiAgCiAgaWYgKGVycm9yKSB7CiAgICBjb25zb2xlLmVy\ncm9yKCdPQXV0aCBlcnJvciBmcm9tIEdITDonLCBlcnJvcik7CiAgICByZXR1\ncm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ09BdXRoIGVycm9y\nJywgZGV0YWlsczogZXJyb3IgfSk7CiAgfQogIAogIGlmICghY29kZSkgewog\nICAgY29uc29sZS5lcnJvcignTm8gYXV0aG9yaXphdGlvbiBjb2RlIHJlY2Vp\ndmVkJyk7CiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJv\ncjogJ2NvZGUgcmVxdWlyZWQnIH0pOwogIH0KICAKICB0cnkgewogICAgY29u\nc3QgcmVkaXJlY3RVcmkgPSByZXEucGF0aC5zdGFydHNXaXRoKCcvYXBpJykK\nICAgICAgPyAocHJvY2Vzcy5lbnYuR0hMX1JFRElSRUNUX1VSSSB8fCAnaHR0\ncHM6Ly9kaXIuZW5nYWdlYXV0b21hdGlvbnMuY29tL2FwaS9vYXV0aC9jYWxs\nYmFjaycpCiAgICAgIDogKHByb2Nlc3MuZW52LkdITF9SRURJUkVDVF9VUkkg\nfHwgJ2h0dHBzOi8vZGlyLmVuZ2FnZWF1dG9tYXRpb25zLmNvbS9vYXV0aC9j\nYWxsYmFjaycpOwoKICAgIGNvbnNvbGUubG9nKCdFeGNoYW5naW5nIGNvZGUg\nZm9yIHRva2Vucy4uLicpOwogICAgY29uc29sZS5sb2coJ1JlZGlyZWN0IFVS\nSTonLCByZWRpcmVjdFVyaSk7CiAgICAKICAgIGNvbnN0IHRva2VuRGF0YSA9\nIGF3YWl0IGV4Y2hhbmdlQ29kZShjb2RlLCByZWRpcmVjdFVyaSk7CiAgICBj\nb25zb2xlLmxvZygnVG9rZW4gZXhjaGFuZ2Ugc3VjY2Vzc2Z1bCcpOwogICAg\nCiAgICBjb25zdCBpZCA9IHN0b3JlSW5zdGFsbCh0b2tlbkRhdGEpOwogICAg\nY29uc29sZS5sb2coJ0luc3RhbGxhdGlvbiBzdG9yZWQgd2l0aCBJRDonLCBp\nZCk7CiAgICAKICAgIGNvbnN0IHVybCA9IGBodHRwczovL2xpc3RpbmdzLmVu\nZ2FnZWF1dG9tYXRpb25zLmNvbS8/aW5zdGFsbGF0aW9uX2lkPSR7aWR9Jndl\nbGNvbWU9dHJ1ZWA7CiAgICBjb25zb2xlLmxvZygnUmVkaXJlY3RpbmcgdG86\nJywgdXJsKTsKICAgIAogICAgcmVzLnJlZGlyZWN0KHVybCk7CiAgfSBjYXRj\naCAoZSkgewogICAgY29uc29sZS5lcnJvcignT0F1dGggZXJyb3I6JywgZS5y\nZXNwb25zZT8uZGF0YSB8fCBlLm1lc3NhZ2UpOwogICAgcmVzLnN0YXR1cyg1\nMDApLmpzb24oeyBlcnJvcjogJ09BdXRoIGZhaWxlZCcsIGRldGFpbHM6IGUu\ncmVzcG9uc2U/LmRhdGEgfHwgZS5tZXNzYWdlIH0pOwogIH0KfSk7CgphcHAu\nZ2V0KCcvYXBpL29hdXRoL3N0YXR1cycsIChyZXEsIHJlcykgPT4gewogIGNv\nbnN0IGluc3QgPSBpbnN0YWxsYXRpb25zLmdldChyZXEucXVlcnkuaW5zdGFs\nbGF0aW9uX2lkKTsKICBpZiAoIWluc3QpIHJldHVybiByZXMuanNvbih7IGF1\ndGhlbnRpY2F0ZWQ6IGZhbHNlIH0pOwogIHJlcy5qc29uKHsgYXV0aGVudGlj\nYXRlZDogdHJ1ZSwgdG9rZW5TdGF0dXM6IGluc3QudG9rZW5TdGF0dXMsIGxv\nY2F0aW9uSWQ6IGluc3QubG9jYXRpb25JZCB9KTsKfSk7CgovLyBNRURJQSBV\nUExPQUQgRU5EUE9JTlQKYXBwLnBvc3QoJy9hcGkvbWVkaWEvdXBsb2FkJywg\ndXBsb2FkLnNpbmdsZSgnZmlsZScpLCBhc3luYyAocmVxLCByZXMpID0+IHsK\nICBjb25zb2xlLmxvZygnPT09IE1FRElBIFVQTE9BRCBSRVFVRVNUID09PScp\nOwogIAogIHRyeSB7CiAgICBjb25zdCB7IGluc3RhbGxhdGlvbl9pZCB9ID0g\ncmVxLmJvZHk7CiAgICAKICAgIGlmICghaW5zdGFsbGF0aW9uX2lkKSB7CiAg\nICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IHN1Y2Nlc3M6IGZh\nbHNlLCBlcnJvcjogJ2luc3RhbGxhdGlvbl9pZCByZXF1aXJlZCcgfSk7CiAg\nICB9CiAgICAKICAgIGlmICghcmVxLmZpbGUpIHsKICAgICAgcmV0dXJuIHJl\ncy5zdGF0dXMoNDAwKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAn\nZmlsZSByZXF1aXJlZCcgfSk7CiAgICB9CiAgICAKICAgIGNvbnNvbGUubG9n\nKGBVcGxvYWRpbmcgZmlsZTogJHtyZXEuZmlsZS5vcmlnaW5hbG5hbWV9ICgk\ne3JlcS5maWxlLnNpemV9IGJ5dGVzKWApOwogICAgCiAgICBhd2FpdCBlbnN1\ncmVGcmVzaFRva2VuKGluc3RhbGxhdGlvbl9pZCk7CiAgICBjb25zdCBpbnN0\nYWxsYXRpb24gPSBpbnN0YWxsYXRpb25zLmdldChpbnN0YWxsYXRpb25faWQp\nOwogICAgCiAgICAvLyBDcmVhdGUgZm9ybSBkYXRhIGZvciBHb0hpZ2hMZXZl\nbCBBUEkKICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAg\nICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBmcy5jcmVhdGVSZWFkU3RyZWFt\nKHJlcS5maWxlLnBhdGgpLCB7CiAgICAgIGZpbGVuYW1lOiByZXEuZmlsZS5v\ncmlnaW5hbG5hbWUsCiAgICAgIGNvbnRlbnRUeXBlOiByZXEuZmlsZS5taW1l\ndHlwZQogICAgfSk7CiAgICAKICAgIC8vIFVwbG9hZCB0byBHb0hpZ2hMZXZl\nbCBtZWRpYSBsaWJyYXJ5CiAgICBjb25zdCB1cGxvYWRSZXNwb25zZSA9IGF3\nYWl0IGF4aW9zLnBvc3QoYGh0dHBzOi8vc2VydmljZXMubGVhZGNvbm5lY3Rv\ncmhxLmNvbS9tZWRpYXMvdXBsb2FkLWZpbGVgLCBmb3JtRGF0YSwgewogICAg\nICBoZWFkZXJzOiB7CiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVy\nICR7aW5zdGFsbGF0aW9uLmFjY2Vzc1Rva2VufWAsCiAgICAgICAgJ1ZlcnNp\nb24nOiAnMjAyMS0wNy0yOCcsCiAgICAgICAgLi4uZm9ybURhdGEuZ2V0SGVh\nZGVycygpCiAgICAgIH0sCiAgICAgIHBhcmFtczogewogICAgICAgIGxvY2F0\naW9uSWQ6IGluc3RhbGxhdGlvbi5sb2NhdGlvbklkCiAgICAgIH0KICAgIH0p\nOwogICAgCiAgICAvLyBDbGVhbiB1cCB1cGxvYWRlZCBmaWxlCiAgICBmcy51\nbmxpbmtTeW5jKHJlcS5maWxlLnBhdGgpOwogICAgCiAgICBjb25zb2xlLmxv\nZygnTWVkaWEgdXBsb2FkIHN1Y2Nlc3NmdWw6JywgdXBsb2FkUmVzcG9uc2Uu\nZGF0YSk7CiAgICAKICAgIHJlcy5qc29uKHsKICAgICAgc3VjY2VzczogdHJ1\nZSwKICAgICAgbWVkaWFVcmw6IHVwbG9hZFJlc3BvbnNlLmRhdGEudXJsIHx8\nIHVwbG9hZFJlc3BvbnNlLmRhdGEuZmlsZVVybCwKICAgICAgbWVkaWFJZDog\ndXBsb2FkUmVzcG9uc2UuZGF0YS5pZCwKICAgICAgZGF0YTogdXBsb2FkUmVz\ncG9uc2UuZGF0YQogICAgfSk7CiAgICAKICB9IGNhdGNoIChlcnJvcikgewog\nICAgLy8gQ2xlYW4gdXAgZmlsZSBpZiBpdCBleGlzdHMKICAgIGlmIChyZXEu\nZmlsZSAmJiBmcy5leGlzdHNTeW5jKHJlcS5maWxlLnBhdGgpKSB7CiAgICAg\nIGZzLnVubGlua1N5bmMocmVxLmZpbGUucGF0aCk7CiAgICB9CiAgICAKICAg\nIGNvbnNvbGUuZXJyb3IoJ01lZGlhIHVwbG9hZCBlcnJvcjonLCBlcnJvci5y\nZXNwb25zZT8uZGF0YSB8fCBlcnJvci5tZXNzYWdlKTsKICAgIHJlcy5zdGF0\ndXMoNTAwKS5qc29uKHsKICAgICAgc3VjY2VzczogZmFsc2UsCiAgICAgIGVy\ncm9yOiBlcnJvci5yZXNwb25zZT8uZGF0YSB8fCBlcnJvci5tZXNzYWdlCiAg\nICB9KTsKICB9Cn0pOwoKLy8gTUVESUEgTElTVCBFTkRQT0lOVAphcHAuZ2V0\nKCcvYXBpL21lZGlhL2xpc3QnLCBhc3luYyAocmVxLCByZXMpID0+IHsKICB0\ncnkgewogICAgY29uc3QgeyBpbnN0YWxsYXRpb25faWQgfSA9IHJlcS5xdWVy\neTsKICAgIAogICAgaWYgKCFpbnN0YWxsYXRpb25faWQpIHsKICAgICAgcmV0\ndXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVy\ncm9yOiAnaW5zdGFsbGF0aW9uX2lkIHJlcXVpcmVkJyB9KTsKICAgIH0KICAg\nIAogICAgYXdhaXQgZW5zdXJlRnJlc2hUb2tlbihpbnN0YWxsYXRpb25faWQp\nOwogICAgY29uc3QgaW5zdGFsbGF0aW9uID0gaW5zdGFsbGF0aW9ucy5nZXQo\naW5zdGFsbGF0aW9uX2lkKTsKICAgIAogICAgY29uc3QgbWVkaWFSZXNwb25z\nZSA9IGF3YWl0IGF4aW9zLmdldCgnaHR0cHM6Ly9zZXJ2aWNlcy5sZWFkY29u\nbmVjdG9yaHEuY29tL21lZGlhcy8nLCB7CiAgICAgIGhlYWRlcnM6IHsKICAg\nICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtpbnN0YWxsYXRpb24u\nYWNjZXNzVG9rZW59YCwKICAgICAgICAnVmVyc2lvbic6ICcyMDIxLTA3LTI4\nJwogICAgICB9LAogICAgICBwYXJhbXM6IHsKICAgICAgICBsb2NhdGlvbklk\nOiBpbnN0YWxsYXRpb24ubG9jYXRpb25JZCwKICAgICAgICBsaW1pdDogMTAw\nCiAgICAgIH0KICAgIH0pOwogICAgCiAgICByZXMuanNvbih7CiAgICAgIHN1\nY2Nlc3M6IHRydWUsCiAgICAgIG1lZGlhOiBtZWRpYVJlc3BvbnNlLmRhdGEu\nbWVkaWFzIHx8IG1lZGlhUmVzcG9uc2UuZGF0YSwKICAgICAgdG90YWw6IG1l\nZGlhUmVzcG9uc2UuZGF0YS5jb3VudCB8fCBtZWRpYVJlc3BvbnNlLmRhdGEu\nbGVuZ3RoCiAgICB9KTsKICAgIAogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICBj\nb25zb2xlLmVycm9yKCdNZWRpYSBsaXN0IGVycm9yOicsIGVycm9yLnJlc3Bv\nbnNlPy5kYXRhIHx8IGVycm9yLm1lc3NhZ2UpOwogICAgcmVzLnN0YXR1cyg1\nMDApLmpzb24oewogICAgICBzdWNjZXNzOiBmYWxzZSwKICAgICAgZXJyb3I6\nIGVycm9yLnJlc3BvbnNlPy5kYXRhIHx8IGVycm9yLm1lc3NhZ2UKICAgIH0p\nOwogIH0KfSk7CgovLyBQUklDSU5HIEVORFBPSU5UCmFwcC5wb3N0KCcvYXBp\nL3Byb2R1Y3RzLzpwcm9kdWN0SWQvcHJpY2VzJywgYXN5bmMgKHJlcSwgcmVz\nKSA9PiB7CiAgdHJ5IHsKICAgIGNvbnN0IHsgcHJvZHVjdElkIH0gPSByZXEu\ncGFyYW1zOwogICAgY29uc3QgeyBpbnN0YWxsYXRpb25faWQsIG5hbWUsIHR5\ncGUsIGFtb3VudCwgY3VycmVuY3kgfSA9IHJlcS5ib2R5OwogICAgCiAgICBp\nZiAoIWluc3RhbGxhdGlvbl9pZCkgewogICAgICByZXR1cm4gcmVzLnN0YXR1\ncyg0MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdpbnN0YWxs\nYXRpb25faWQgcmVxdWlyZWQnIH0pOwogICAgfQogICAgCiAgICBhd2FpdCBl\nbnN1cmVGcmVzaFRva2VuKGluc3RhbGxhdGlvbl9pZCk7CiAgICBjb25zdCBp\nbnN0YWxsYXRpb24gPSBpbnN0YWxsYXRpb25zLmdldChpbnN0YWxsYXRpb25f\naWQpOwogICAgCiAgICBjb25zdCBwcmljZURhdGEgPSB7CiAgICAgIG5hbWUs\nCiAgICAgIHR5cGUsCiAgICAgIGFtb3VudDogcGFyc2VJbnQoYW1vdW50KSwK\nICAgICAgY3VycmVuY3k6IGN1cnJlbmN5IHx8ICdVU0QnCiAgICB9OwogICAg\nCiAgICBjb25zdCBwcmljZVJlc3BvbnNlID0gYXdhaXQgYXhpb3MucG9zdChg\naHR0cHM6Ly9zZXJ2aWNlcy5sZWFkY29ubmVjdG9yaHEuY29tL3Byb2R1Y3Rz\nLyR7cHJvZHVjdElkfS9wcmljZXNgLCBwcmljZURhdGEsIHsKICAgICAgaGVh\nZGVyczogewogICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2lu\nc3RhbGxhdGlvbi5hY2Nlc3NUb2tlbn1gLAogICAgICAgICdWZXJzaW9uJzog\nJzIwMjEtMDctMjgnLAogICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGlj\nYXRpb24vanNvbicKICAgICAgfQogICAgfSk7CiAgICAKICAgIGNvbnNvbGUu\nbG9nKCdQcmljZSBjcmVhdGVkOicsIHByaWNlUmVzcG9uc2UuZGF0YSk7CiAg\nICAKICAgIHJlcy5qc29uKHsKICAgICAgc3VjY2VzczogdHJ1ZSwKICAgICAg\ncHJpY2U6IHByaWNlUmVzcG9uc2UuZGF0YQogICAgfSk7CiAgICAKICB9IGNh\ndGNoIChlcnJvcikgewogICAgY29uc29sZS5lcnJvcignUHJpY2UgY3JlYXRp\nb24gZXJyb3I6JywgZXJyb3IucmVzcG9uc2U/LmRhdGEgfHwgZXJyb3IubWVz\nc2FnZSk7CiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7CiAgICAgIHN1Y2Nl\nc3M6IGZhbHNlLAogICAgICBlcnJvcjogZXJyb3IucmVzcG9uc2U/LmRhdGEg\nfHwgZXJyb3IubWVzc2FnZQogICAgfSk7CiAgfQp9KTsKCi8vIFBST0RVQ1Qg\nQ1JFQVRJT04gRU5EUE9JTlQKYXBwLnBvc3QoJy9hcGkvcHJvZHVjdHMvY3Jl\nYXRlJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7CiAgY29uc29sZS5sb2coJz09\nPSBQUk9EVUNUIENSRUFUSU9OIFJFUVVFU1QgPT09Jyk7CiAgCiAgdHJ5IHsK\nICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIHByb2R1Y3RUeXBlLCBz\na3UsIGN1cnJlbmN5LCBpbnN0YWxsYXRpb25faWQgfSA9IHJlcS5ib2R5Owog\nICAgCiAgICBpZiAoIWluc3RhbGxhdGlvbl9pZCkgewogICAgICByZXR1cm4g\ncmVzLnN0YXR1cyg0MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6\nICdpbnN0YWxsYXRpb25faWQgcmVxdWlyZWQnIH0pOwogICAgfQogICAgCiAg\nICBpZiAoIW5hbWUpIHsKICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5q\nc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAncHJvZHVjdCBuYW1lIHJl\ncXVpcmVkJyB9KTsKICAgIH0KICAgIAogICAgY29uc29sZS5sb2coYENyZWF0\naW5nIHByb2R1Y3Q6ICR7bmFtZX1gKTsKICAgIAogICAgYXdhaXQgZW5zdXJl\nRnJlc2hUb2tlbihpbnN0YWxsYXRpb25faWQpOwogICAgY29uc3QgaW5zdGFs\nbGF0aW9uID0gaW5zdGFsbGF0aW9ucy5nZXQoaW5zdGFsbGF0aW9uX2lkKTsK\nICAgIAogICAgY29uc3QgcHJvZHVjdERhdGEgPSB7CiAgICAgIG5hbWUsCiAg\nICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB8fCAnJywKICAgICAgcHJv\nZHVjdFR5cGU6IHByb2R1Y3RUeXBlIHx8ICdQSFlTSUNBTCcsCiAgICAgIC4u\nLihza3UgJiYgeyBza3UgfSksCiAgICAgIC4uLihjdXJyZW5jeSAmJiB7IGN1\ncnJlbmN5IH0pCiAgICB9OwogICAgCiAgICAvLyBDcmVhdGUgcHJvZHVjdCBp\nbiBHb0hpZ2hMZXZlbAogICAgY29uc3QgcHJvZHVjdFJlc3BvbnNlID0gYXdh\naXQgYXhpb3MucG9zdCgnaHR0cHM6Ly9zZXJ2aWNlcy5sZWFkY29ubmVjdG9y\naHEuY29tL3Byb2R1Y3RzLycsIHByb2R1Y3REYXRhLCB7CiAgICAgIGhlYWRl\ncnM6IHsKICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtpbnN0\nYWxsYXRpb24uYWNjZXNzVG9rZW59YCwKICAgICAgICAnVmVyc2lvbic6ICcy\nMDIxLTA3LTI4JywKICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0\naW9uL2pzb24nCiAgICAgIH0KICAgIH0pOwogICAgCiAgICBjb25zb2xlLmxv\nZygnUHJvZHVjdCBjcmVhdGlvbiBzdWNjZXNzZnVsOicsIHByb2R1Y3RSZXNw\nb25zZS5kYXRhKTsKICAgIAogICAgcmVzLmpzb24oewogICAgICBzdWNjZXNz\nOiB0cnVlLAogICAgICBwcm9kdWN0OiBwcm9kdWN0UmVzcG9uc2UuZGF0YS5w\ncm9kdWN0IHx8IHByb2R1Y3RSZXNwb25zZS5kYXRhLAogICAgICBtZXNzYWdl\nOiAnUHJvZHVjdCBjcmVhdGVkIHN1Y2Nlc3NmdWxseSBpbiBHb0hpZ2hMZXZl\nbCcKICAgIH0pOwogICAgCiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGNvbnNv\nbGUuZXJyb3IoJ1Byb2R1Y3QgY3JlYXRpb24gZXJyb3I6JywgZXJyb3IucmVz\ncG9uc2U/LmRhdGEgfHwgZXJyb3IubWVzc2FnZSk7CiAgICByZXMuc3RhdHVz\nKDUwMCkuanNvbih7CiAgICAgIHN1Y2Nlc3M6IGZhbHNlLAogICAgICBlcnJv\ncjogZXJyb3IucmVzcG9uc2U/LmRhdGEgfHwgZXJyb3IubWVzc2FnZSwKICAg\nICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBjcmVhdGUgcHJvZHVjdCBpbiBHb0hp\nZ2hMZXZlbCcKICAgIH0pOwogIH0KfSk7CgovLyBQUk9EVUNUIExJU1RJTkcg\nRU5EUE9JTlQKYXBwLmdldCgnL2FwaS9wcm9kdWN0cy9saXN0JywgYXN5bmMg\nKHJlcSwgcmVzKSA9PiB7CiAgY29uc29sZS5sb2coJz09PSBQUk9EVUNUIExJ\nU1RJTkcgUkVRVUVTVCA9PT0nKTsKICAKICB0cnkgewogICAgY29uc3QgeyBp\nbnN0YWxsYXRpb25faWQgfSA9IHJlcS5xdWVyeTsKICAgIAogICAgaWYgKCFp\nbnN0YWxsYXRpb25faWQpIHsKICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAw\nKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnaW5zdGFsbGF0aW9u\nX2lkIHJlcXVpcmVkJyB9KTsKICAgIH0KICAgIAogICAgYXdhaXQgZW5zdXJl\nRnJlc2hUb2tlbihpbnN0YWxsYXRpb25faWQpOwogICAgY29uc3QgaW5zdGFs\nbGF0aW9uID0gaW5zdGFsbGF0aW9ucy5nZXQoaW5zdGFsbGF0aW9uX2lkKTsK\nICAgIAogICAgY29uc3QgcHJvZHVjdHNSZXNwb25zZSA9IGF3YWl0IGF4aW9z\nLmdldCgnaHR0cHM6Ly9zZXJ2aWNlcy5sZWFkY29ubmVjdG9yaHEuY29tL3By\nb2R1Y3RzLycsIHsKICAgICAgaGVhZGVyczogewogICAgICAgICdBdXRob3Jp\nemF0aW9uJzogYEJlYXJlciAke2luc3RhbGxhdGlvbi5hY2Nlc3NUb2tlbn1g\nLAogICAgICAgICdWZXJzaW9uJzogJzIwMjEtMDctMjgnCiAgICAgIH0sCiAg\nICAgIHBhcmFtczogewogICAgICAgIGxvY2F0aW9uSWQ6IGluc3RhbGxhdGlv\nbi5sb2NhdGlvbklkLAogICAgICAgIGxpbWl0OiAxMDAKICAgICAgfQogICAg\nfSk7CiAgICAKICAgIGNvbnNvbGUubG9nKCdQcm9kdWN0cyByZXRyaWV2ZWQ6\nJywgcHJvZHVjdHNSZXNwb25zZS5kYXRhLnByb2R1Y3RzPy5sZW5ndGggfHwg\nMCk7CiAgICAKICAgIHJlcy5qc29uKHsKICAgICAgc3VjY2VzczogdHJ1ZSwK\nICAgICAgcHJvZHVjdHM6IHByb2R1Y3RzUmVzcG9uc2UuZGF0YS5wcm9kdWN0\ncyB8fCBbXSwKICAgICAgY291bnQ6IHByb2R1Y3RzUmVzcG9uc2UuZGF0YS5w\ncm9kdWN0cz8ubGVuZ3RoIHx8IDAKICAgIH0pOwogICAgCiAgfSBjYXRjaCAo\nZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ1Byb2R1Y3QgbGlzdGluZyBl\ncnJvcjonLCBlcnJvci5yZXNwb25zZT8uZGF0YSB8fCBlcnJvci5tZXNzYWdl\nKTsKICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsKICAgICAgc3VjY2Vzczog\nZmFsc2UsCiAgICAgIGVycm9yOiBlcnJvci5yZXNwb25zZT8uZGF0YSB8fCBl\ncnJvci5tZXNzYWdlLAogICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHJldHJp\nZXZlIHByb2R1Y3RzIGZyb20gR29IaWdoTGV2ZWwnCiAgICB9KTsKICB9Cn0p\nOwoKLy8gQ1VTVE9NRVIgU1VQUE9SVCBFTkRQT0lOVFMKCi8vIENyZWF0ZSBz\ndXBwb3J0IHRpY2tldAphcHAucG9zdCgnL2FwaS9zdXBwb3J0L3RpY2tldHMn\nLCBhc3luYyAocmVxLCByZXMpID0+IHsKICBjb25zb2xlLmxvZygnPT09IFNV\nUFBPUlQgVElDS0VUIENSRUFUSU9OID09PScpOwogIAogIHRyeSB7CiAgICBj\nb25zdCB7IAogICAgICBjdXN0b21lckVtYWlsLCAKICAgICAgY3VzdG9tZXJO\nYW1lLAogICAgICBzdWJqZWN0LCAKICAgICAgZGVzY3JpcHRpb24sIAogICAg\nICBwcmlvcml0eSA9ICdtZWRpdW0nLAogICAgICBjYXRlZ29yeSA9ICdnZW5l\ncmFsJywKICAgICAgaW5zdGFsbGF0aW9uSWQgCiAgICB9ID0gcmVxLmJvZHk7\nCiAgICAKICAgIGlmICghY3VzdG9tZXJFbWFpbCB8fCAhc3ViamVjdCB8fCAh\nZGVzY3JpcHRpb24pIHsKICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5q\nc29uKHsgCiAgICAgICAgc3VjY2VzczogZmFsc2UsIAogICAgICAgIGVycm9y\nOiAnY3VzdG9tZXJFbWFpbCwgc3ViamVjdCwgYW5kIGRlc2NyaXB0aW9uIGFy\nZSByZXF1aXJlZCcgCiAgICAgIH0pOwogICAgfQogICAgCiAgICBjb25zdCB0\naWNrZXRJZCA9ICd0aWNrZXRfJyArIERhdGUubm93KCk7CiAgICBjb25zdCB0\naWNrZXQgPSB7CiAgICAgIGlkOiB0aWNrZXRJZCwKICAgICAgY3VzdG9tZXJF\nbWFpbCwKICAgICAgY3VzdG9tZXJOYW1lOiBjdXN0b21lck5hbWUgfHwgJ1Vu\na25vd24nLAogICAgICBzdWJqZWN0LAogICAgICBkZXNjcmlwdGlvbiwKICAg\nICAgcHJpb3JpdHksIC8vIGxvdywgbWVkaXVtLCBoaWdoLCB1cmdlbnQKICAg\nICAgY2F0ZWdvcnksIC8vIGdlbmVyYWwsIHRlY2huaWNhbCwgYmlsbGluZywg\nZmVhdHVyZV9yZXF1ZXN0CiAgICAgIHN0YXR1czogJ29wZW4nLCAvLyBvcGVu\nLCBpbl9wcm9ncmVzcywgd2FpdGluZ19jdXN0b21lciwgcmVzb2x2ZWQsIGNs\nb3NlZAogICAgICBpbnN0YWxsYXRpb25JZCwKICAgICAgY3JlYXRlZEF0OiBu\nZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksCiAgICAgIHVwZGF0ZWRBdDogbmV3\nIERhdGUoKS50b0lTT1N0cmluZygpLAogICAgICBtZXNzYWdlczogW3sKICAg\nICAgICBpZDogJ21zZ18nICsgRGF0ZS5ub3coKSwKICAgICAgICBmcm9tOiAn\nY3VzdG9tZXInLAogICAgICAgIGNvbnRlbnQ6IGRlc2NyaXB0aW9uLAogICAg\nICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpCiAgICAg\nIH1dLAogICAgICBhc3NpZ25lZFRvOiBudWxsLAogICAgICB0YWdzOiBbXSwK\nICAgICAgc2F0aXNmYWN0aW9uOiBudWxsCiAgICB9OwogICAgCiAgICBzdXBw\nb3J0VGlja2V0cy5zZXQodGlja2V0SWQsIHRpY2tldCk7CiAgICBzdXBwb3J0\nTWV0cmljcy50b3RhbFRpY2tldHMrKzsKICAgIAogICAgY29uc29sZS5sb2co\nYFN1cHBvcnQgdGlja2V0IGNyZWF0ZWQ6ICR7dGlja2V0SWR9YCk7CiAgICAK\nICAgIHJlcy5qc29uKHsKICAgICAgc3VjY2VzczogdHJ1ZSwKICAgICAgdGlj\na2V0LAogICAgICBtZXNzYWdlOiAnU3VwcG9ydCB0aWNrZXQgY3JlYXRlZCBz\ndWNjZXNzZnVsbHknCiAgICB9KTsKICAgIAogIH0gY2F0Y2ggKGVycm9yKSB7\nCiAgICBjb25zb2xlLmVycm9yKCdTdXBwb3J0IHRpY2tldCBjcmVhdGlvbiBl\ncnJvcjonLCBlcnJvci5tZXNzYWdlKTsKICAgIHJlcy5zdGF0dXMoNTAwKS5q\nc29uKHsKICAgICAgc3VjY2VzczogZmFsc2UsCiAgICAgIGVycm9yOiBlcnJv\nci5tZXNzYWdlLAogICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIGNyZWF0ZSBz\ndXBwb3J0IHRpY2tldCcKICAgIH0pOwogIH0KfSk7CgovLyBHZXQgc3VwcG9y\ndCB0aWNrZXRzIChhZG1pbiB2aWV3KQphcHAuZ2V0KCcvYXBpL3N1cHBvcnQv\ndGlja2V0cycsIChyZXEsIHJlcykgPT4gewogIHRyeSB7CiAgICBjb25zdCB7\nIHN0YXR1cywgcHJpb3JpdHksIGNhdGVnb3J5LCBjdXN0b21lckVtYWlsIH0g\nPSByZXEucXVlcnk7CiAgICBsZXQgdGlja2V0cyA9IEFycmF5LmZyb20oc3Vw\ncG9ydFRpY2tldHMudmFsdWVzKCkpOwogICAgCiAgICAvLyBBcHBseSBmaWx0\nZXJzCiAgICBpZiAoc3RhdHVzKSB0aWNrZXRzID0gdGlja2V0cy5maWx0ZXIo\ndCA9PiB0LnN0YXR1cyA9PT0gc3RhdHVzKTsKICAgIGlmIChwcmlvcml0eSkg\ndGlja2V0cyA9IHRpY2tldHMuZmlsdGVyKHQgPT4gdC5wcmlvcml0eSA9PT0g\ncHJpb3JpdHkpOwogICAgaWYgKGNhdGVnb3J5KSB0aWNrZXRzID0gdGlja2V0\ncy5maWx0ZXIodCA9PiB0LmNhdGVnb3J5ID09PSBjYXRlZ29yeSk7CiAgICBp\nZiAoY3VzdG9tZXJFbWFpbCkgdGlja2V0cyA9IHRpY2tldHMuZmlsdGVyKHQg\nPT4gdC5jdXN0b21lckVtYWlsID09PSBjdXN0b21lckVtYWlsKTsKICAgIAog\nICAgLy8gU29ydCBieSBjcmVhdGlvbiBkYXRlIChuZXdlc3QgZmlyc3QpCiAg\nICB0aWNrZXRzLnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGIuY3JlYXRlZEF0\nKSAtIG5ldyBEYXRlKGEuY3JlYXRlZEF0KSk7CiAgICAKICAgIHJlcy5qc29u\nKHsKICAgICAgc3VjY2VzczogdHJ1ZSwKICAgICAgdGlja2V0cywKICAgICAg\nY291bnQ6IHRpY2tldHMubGVuZ3RoLAogICAgICBtZXRyaWNzOiBzdXBwb3J0\nTWV0cmljcwogICAgfSk7CiAgICAKICB9IGNhdGNoIChlcnJvcikgewogICAg\ncmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6\nIGVycm9yLm1lc3NhZ2UgfSk7CiAgfQp9KTsKCi8vIEdldCBzcGVjaWZpYyB0\naWNrZXQKYXBwLmdldCgnL2FwaS9zdXBwb3J0L3RpY2tldHMvOnRpY2tldElk\nJywgKHJlcSwgcmVzKSA9PiB7CiAgdHJ5IHsKICAgIGNvbnN0IHRpY2tldCA9\nIHN1cHBvcnRUaWNrZXRzLmdldChyZXEucGFyYW1zLnRpY2tldElkKTsKICAg\nIAogICAgaWYgKCF0aWNrZXQpIHsKICAgICAgcmV0dXJuIHJlcy5zdGF0dXMo\nNDA0KS5qc29uKHsgCiAgICAgICAgc3VjY2VzczogZmFsc2UsIAogICAgICAg\nIGVycm9yOiAnVGlja2V0IG5vdCBmb3VuZCcgCiAgICAgIH0pOwogICAgfQog\nICAgCiAgICByZXMuanNvbih7IHN1Y2Nlc3M6IHRydWUsIHRpY2tldCB9KTsK\nICAgIAogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICByZXMuc3RhdHVzKDUwMCku\nanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9\nKTsKICB9Cn0pOwoKLy8gVXBkYXRlIHRpY2tldCBzdGF0dXMKYXBwLnBhdGNo\nKCcvYXBpL3N1cHBvcnQvdGlja2V0cy86dGlja2V0SWQnLCAocmVxLCByZXMp\nID0+IHsKICB0cnkgewogICAgY29uc3QgdGlja2V0ID0gc3VwcG9ydFRpY2tl\ndHMuZ2V0KHJlcS5wYXJhbXMudGlja2V0SWQpOwogICAgCiAgICBpZiAoIXRp\nY2tldCkgewogICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyAK\nICAgICAgICBzdWNjZXNzOiBmYWxzZSwgCiAgICAgICAgZXJyb3I6ICdUaWNr\nZXQgbm90IGZvdW5kJyAKICAgICAgfSk7CiAgICB9CiAgICAKICAgIGNvbnN0\nIHsgc3RhdHVzLCBhc3NpZ25lZFRvLCBwcmlvcml0eSwgdGFncyB9ID0gcmVx\nLmJvZHk7CiAgICAKICAgIGlmIChzdGF0dXMpIHRpY2tldC5zdGF0dXMgPSBz\ndGF0dXM7CiAgICBpZiAoYXNzaWduZWRUbyAhPT0gdW5kZWZpbmVkKSB0aWNr\nZXQuYXNzaWduZWRUbyA9IGFzc2lnbmVkVG87CiAgICBpZiAocHJpb3JpdHkp\nIHRpY2tldC5wcmlvcml0eSA9IHByaW9yaXR5OwogICAgaWYgKHRhZ3MpIHRp\nY2tldC50YWdzID0gdGFnczsKICAgIAogICAgdGlja2V0LnVwZGF0ZWRBdCA9\nIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTsKICAgIAogICAgLy8gVXBkYXRl\nIG1ldHJpY3MKICAgIGlmIChzdGF0dXMgPT09ICdyZXNvbHZlZCcgfHwgc3Rh\ndHVzID09PSAnY2xvc2VkJykgewogICAgICBzdXBwb3J0TWV0cmljcy5yZXNv\nbHZlZFRpY2tldHMrKzsKICAgIH0KICAgIAogICAgc3VwcG9ydFRpY2tldHMu\nc2V0KHJlcS5wYXJhbXMudGlja2V0SWQsIHRpY2tldCk7CiAgICAKICAgIHJl\ncy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgdGlja2V0IH0pOwogICAgCiAgfSBj\nYXRjaCAoZXJyb3IpIHsKICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgc3Vj\nY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0pOwogIH0KfSk7\nCgovLyBBZGQgbWVzc2FnZSB0byB0aWNrZXQKYXBwLnBvc3QoJy9hcGkvc3Vw\ncG9ydC90aWNrZXRzLzp0aWNrZXRJZC9tZXNzYWdlcycsIChyZXEsIHJlcykg\nPT4gewogIHRyeSB7CiAgICBjb25zdCB0aWNrZXQgPSBzdXBwb3J0VGlja2V0\ncy5nZXQocmVxLnBhcmFtcy50aWNrZXRJZCk7CiAgICAKICAgIGlmICghdGlj\na2V0KSB7CiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IAog\nICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCAKICAgICAgICBlcnJvcjogJ1RpY2tl\ndCBub3QgZm91bmQnIAogICAgICB9KTsKICAgIH0KICAgIAogICAgY29uc3Qg\neyBjb250ZW50LCBmcm9tID0gJ3N1cHBvcnQnIH0gPSByZXEuYm9keTsKICAg\nIAogICAgaWYgKCFjb250ZW50KSB7CiAgICAgIHJldHVybiByZXMuc3RhdHVz\nKDQwMCkuanNvbih7IAogICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCAKICAgICAg\nICBlcnJvcjogJ01lc3NhZ2UgY29udGVudCBpcyByZXF1aXJlZCcgCiAgICAg\nIH0pOwogICAgfQogICAgCiAgICBjb25zdCBtZXNzYWdlID0gewogICAgICBp\nZDogJ21zZ18nICsgRGF0ZS5ub3coKSwKICAgICAgZnJvbSwgLy8gJ2N1c3Rv\nbWVyJyBvciAnc3VwcG9ydCcKICAgICAgY29udGVudCwKICAgICAgdGltZXN0\nYW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkKICAgIH07CiAgICAKICAg\nIHRpY2tldC5tZXNzYWdlcy5wdXNoKG1lc3NhZ2UpOwogICAgdGlja2V0LnVw\nZGF0ZWRBdCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTsKICAgIAogICAg\nc3VwcG9ydFRpY2tldHMuc2V0KHJlcS5wYXJhbXMudGlja2V0SWQsIHRpY2tl\ndCk7CiAgICAKICAgIHJlcy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2Fn\nZSwgdGlja2V0IH0pOwogICAgCiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIHJl\ncy5zdGF0dXMoNTAwKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBl\ncnJvci5tZXNzYWdlIH0pOwogIH0KfSk7CgovLyBDdXN0b21lciBzYXRpc2Zh\nY3Rpb24gcmF0aW5nCmFwcC5wb3N0KCcvYXBpL3N1cHBvcnQvdGlja2V0cy86\ndGlja2V0SWQvc2F0aXNmYWN0aW9uJywgKHJlcSwgcmVzKSA9PiB7CiAgdHJ5\nIHsKICAgIGNvbnN0IHRpY2tldCA9IHN1cHBvcnRUaWNrZXRzLmdldChyZXEu\ncGFyYW1zLnRpY2tldElkKTsKICAgIAogICAgaWYgKCF0aWNrZXQpIHsKICAg\nICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgCiAgICAgICAgc3Vj\nY2VzczogZmFsc2UsIAogICAgICAgIGVycm9yOiAnVGlja2V0IG5vdCBmb3Vu\nZCcgCiAgICAgIH0pOwogICAgfQogICAgCiAgICBjb25zdCB7IHJhdGluZywg\nZmVlZGJhY2sgfSA9IHJlcS5ib2R5OyAvLyByYXRpbmc6IDEtNQogICAgCiAg\nICBpZiAoIXJhdGluZyB8fCByYXRpbmcgPCAxIHx8IHJhdGluZyA+IDUpIHsK\nICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgCiAgICAgICAg\nc3VjY2VzczogZmFsc2UsIAogICAgICAgIGVycm9yOiAnUmF0aW5nIG11c3Qg\nYmUgYmV0d2VlbiAxIGFuZCA1JyAKICAgICAgfSk7CiAgICB9CiAgICAKICAg\nIHRpY2tldC5zYXRpc2ZhY3Rpb24gPSB7IHJhdGluZywgZmVlZGJhY2ssIHN1\nYm1pdHRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfTsKICAgIHRp\nY2tldC51cGRhdGVkQXQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7CiAg\nICAKICAgIHN1cHBvcnRUaWNrZXRzLnNldChyZXEucGFyYW1zLnRpY2tldElk\nLCB0aWNrZXQpOwogICAgCiAgICAvLyBVcGRhdGUgYXZlcmFnZSBzYXRpc2Zh\nY3Rpb24KICAgIGNvbnN0IHNhdGlzZmFjdGlvblJhdGluZ3MgPSBBcnJheS5m\ncm9tKHN1cHBvcnRUaWNrZXRzLnZhbHVlcygpKQogICAgICAuZmlsdGVyKHQg\nPT4gdC5zYXRpc2ZhY3Rpb24pCiAgICAgIC5tYXAodCA9PiB0LnNhdGlzZmFj\ndGlvbi5yYXRpbmcpOwogICAgICAKICAgIGlmIChzYXRpc2ZhY3Rpb25SYXRp\nbmdzLmxlbmd0aCA+IDApIHsKICAgICAgc3VwcG9ydE1ldHJpY3MuY3VzdG9t\nZXJTYXRpc2ZhY3Rpb24gPSAKICAgICAgICBzYXRpc2ZhY3Rpb25SYXRpbmdz\nLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApIC8gc2F0aXNmYWN0aW9uUmF0\naW5ncy5sZW5ndGg7CiAgICB9CiAgICAKICAgIHJlcy5qc29uKHsgc3VjY2Vz\nczogdHJ1ZSwgdGlja2V0IH0pOwogICAgCiAgfSBjYXRjaCAoZXJyb3IpIHsK\nICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVy\ncm9yOiBlcnJvci5tZXNzYWdlIH0pOwogIH0KfSk7CgovLyBTdXBwb3J0IGFu\nYWx5dGljcyBkYXNoYm9hcmQKYXBwLmdldCgnL2FwaS9zdXBwb3J0L2FuYWx5\ndGljcycsIChyZXEsIHJlcykgPT4gewogIHRyeSB7CiAgICBjb25zdCB0aWNr\nZXRzID0gQXJyYXkuZnJvbShzdXBwb3J0VGlja2V0cy52YWx1ZXMoKSk7CiAg\nICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOwogICAgY29uc3QgbGFzdDMwRGF5\ncyA9IG5ldyBEYXRlKG5vdyAtIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCk7\nCiAgICAKICAgIGNvbnN0IGFuYWx5dGljcyA9IHsKICAgICAgb3ZlcnZpZXc6\nIHN1cHBvcnRNZXRyaWNzLAogICAgICB0aWNrZXRzQnlTdGF0dXM6IHsKICAg\nICAgICBvcGVuOiB0aWNrZXRzLmZpbHRlcih0ID0+IHQuc3RhdHVzID09PSAn\nb3BlbicpLmxlbmd0aCwKICAgICAgICBpbl9wcm9ncmVzczogdGlja2V0cy5m\naWx0ZXIodCA9PiB0LnN0YXR1cyA9PT0gJ2luX3Byb2dyZXNzJykubGVuZ3Ro\nLAogICAgICAgIHdhaXRpbmdfY3VzdG9tZXI6IHRpY2tldHMuZmlsdGVyKHQg\nPT4gdC5zdGF0dXMgPT09ICd3YWl0aW5nX2N1c3RvbWVyJykubGVuZ3RoLAog\nICAgICAgIHJlc29sdmVkOiB0aWNrZXRzLmZpbHRlcih0ID0+IHQuc3RhdHVz\nID09PSAncmVzb2x2ZWQnKS5sZW5ndGgsCiAgICAgICAgY2xvc2VkOiB0aWNr\nZXRzLmZpbHRlcih0ID0+IHQuc3RhdHVzID09PSAnY2xvc2VkJykubGVuZ3Ro\nCiAgICAgIH0sCiAgICAgIHRpY2tldHNCeVByaW9yaXR5OiB7CiAgICAgICAg\nbG93OiB0aWNrZXRzLmZpbHRlcih0ID0+IHQucHJpb3JpdHkgPT09ICdsb3cn\nKS5sZW5ndGgsCiAgICAgICAgbWVkaXVtOiB0aWNrZXRzLmZpbHRlcih0ID0+\nIHQucHJpb3JpdHkgPT09ICdtZWRpdW0nKS5sZW5ndGgsCiAgICAgICAgaGln\naDogdGlja2V0cy5maWx0ZXIodCA9PiB0LnByaW9yaXR5ID09PSAnaGlnaCcp\nLmxlbmd0aCwKICAgICAgICB1cmdlbnQ6IHRpY2tldHMuZmlsdGVyKHQgPT4g\ndC5wcmlvcml0eSA9PT0gJ3VyZ2VudCcpLmxlbmd0aAogICAgICB9LAogICAg\nICB0aWNrZXRzQnlDYXRlZ29yeTogewogICAgICAgIGdlbmVyYWw6IHRpY2tl\ndHMuZmlsdGVyKHQgPT4gdC5jYXRlZ29yeSA9PT0gJ2dlbmVyYWwnKS5sZW5n\ndGgsCiAgICAgICAgdGVjaG5pY2FsOiB0aWNrZXRzLmZpbHRlcih0ID0+IHQu\nY2F0ZWdvcnkgPT09ICd0ZWNobmljYWwnKS5sZW5ndGgsCiAgICAgICAgYmls\nbGluZzogdGlja2V0cy5maWx0ZXIodCA9PiB0LmNhdGVnb3J5ID09PSAnYmls\nbGluZycpLmxlbmd0aCwKICAgICAgICBmZWF0dXJlX3JlcXVlc3Q6IHRpY2tl\ndHMuZmlsdGVyKHQgPT4gdC5jYXRlZ29yeSA9PT0gJ2ZlYXR1cmVfcmVxdWVz\ndCcpLmxlbmd0aAogICAgICB9LAogICAgICByZWNlbnRBY3Rpdml0eTogdGlj\na2V0cwogICAgICAgIC5maWx0ZXIodCA9PiBuZXcgRGF0ZSh0LmNyZWF0ZWRB\ndCkgPiBsYXN0MzBEYXlzKQogICAgICAgIC5sZW5ndGgsCiAgICAgIGF2ZXJh\nZ2VSZXNvbHV0aW9uVGltZTogY2FsY3VsYXRlQXZlcmFnZVJlc29sdXRpb25U\naW1lKHRpY2tldHMpLAogICAgICB0b3BDdXN0b21lcnM6IGdldFRvcEN1c3Rv\nbWVycyh0aWNrZXRzKQogICAgfTsKICAgIAogICAgcmVzLmpzb24oeyBzdWNj\nZXNzOiB0cnVlLCBhbmFseXRpY3MgfSk7CiAgICAKICB9IGNhdGNoIChlcnJv\ncikgewogICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxz\nZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7CiAgfQp9KTsKCi8vIEN1c3Rv\nbWVyIHNlbGYtc2VydmljZSBwb3J0YWwKYXBwLmdldCgnL2FwaS9zdXBwb3J0\nL2N1c3RvbWVyLzpjdXN0b21lckVtYWlsL3RpY2tldHMnLCAocmVxLCByZXMp\nID0+IHsKICB0cnkgewogICAgY29uc3QgY3VzdG9tZXJFbWFpbCA9IHJlcS5w\nYXJhbXMuY3VzdG9tZXJFbWFpbDsKICAgIGNvbnN0IHRpY2tldHMgPSBBcnJh\neS5mcm9tKHN1cHBvcnRUaWNrZXRzLnZhbHVlcygpKQogICAgICAuZmlsdGVy\nKHQgPT4gdC5jdXN0b21lckVtYWlsID09PSBjdXN0b21lckVtYWlsKQogICAg\nICAuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi5jcmVhdGVkQXQpIC0gbmV3\nIERhdGUoYS5jcmVhdGVkQXQpKTsKICAgIAogICAgcmVzLmpzb24oewogICAg\nICBzdWNjZXNzOiB0cnVlLAogICAgICB0aWNrZXRzOiB0aWNrZXRzLm1hcCh0\nID0+ICh7CiAgICAgICAgaWQ6IHQuaWQsCiAgICAgICAgc3ViamVjdDogdC5z\ndWJqZWN0LAogICAgICAgIHN0YXR1czogdC5zdGF0dXMsCiAgICAgICAgcHJp\nb3JpdHk6IHQucHJpb3JpdHksCiAgICAgICAgY2F0ZWdvcnk6IHQuY2F0ZWdv\ncnksCiAgICAgICAgY3JlYXRlZEF0OiB0LmNyZWF0ZWRBdCwKICAgICAgICB1\ncGRhdGVkQXQ6IHQudXBkYXRlZEF0LAogICAgICAgIG1lc3NhZ2VDb3VudDog\ndC5tZXNzYWdlcy5sZW5ndGgKICAgICAgfSkpLAogICAgICBjb3VudDogdGlj\na2V0cy5sZW5ndGgKICAgIH0pOwogICAgCiAgfSBjYXRjaCAoZXJyb3IpIHsK\nICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVy\ncm9yOiBlcnJvci5tZXNzYWdlIH0pOwogIH0KfSk7CgovLyBIZWxwZXIgZnVu\nY3Rpb25zCmZ1bmN0aW9uIGNhbGN1bGF0ZUF2ZXJhZ2VSZXNvbHV0aW9uVGlt\nZSh0aWNrZXRzKSB7CiAgY29uc3QgcmVzb2x2ZWRUaWNrZXRzID0gdGlja2V0\ncy5maWx0ZXIodCA9PiB0LnN0YXR1cyA9PT0gJ3Jlc29sdmVkJyB8fCB0LnN0\nYXR1cyA9PT0gJ2Nsb3NlZCcpOwogIGlmIChyZXNvbHZlZFRpY2tldHMubGVu\nZ3RoID09PSAwKSByZXR1cm4gMDsKICAKICBjb25zdCB0b3RhbFRpbWUgPSBy\nZXNvbHZlZFRpY2tldHMucmVkdWNlKChzdW0sIHRpY2tldCkgPT4gewogICAg\nY29uc3QgY3JlYXRlZCA9IG5ldyBEYXRlKHRpY2tldC5jcmVhdGVkQXQpOwog\nICAgY29uc3QgdXBkYXRlZCA9IG5ldyBEYXRlKHRpY2tldC51cGRhdGVkQXQp\nOwogICAgcmV0dXJuIHN1bSArICh1cGRhdGVkIC0gY3JlYXRlZCk7CiAgfSwg\nMCk7CiAgCiAgcmV0dXJuIE1hdGgucm91bmQodG90YWxUaW1lIC8gcmVzb2x2\nZWRUaWNrZXRzLmxlbmd0aCAvICgxMDAwICogNjAgKiA2MCkpOyAvLyBob3Vy\ncwp9CgpmdW5jdGlvbiBnZXRUb3BDdXN0b21lcnModGlja2V0cykgewogIGNv\nbnN0IGN1c3RvbWVyQ291bnRzID0ge307CiAgdGlja2V0cy5mb3JFYWNoKHRp\nY2tldCA9PiB7CiAgICBjdXN0b21lckNvdW50c1t0aWNrZXQuY3VzdG9tZXJF\nbWFpbF0gPSAoY3VzdG9tZXJDb3VudHNbdGlja2V0LmN1c3RvbWVyRW1haWxd\nIHx8IDApICsgMTsKICB9KTsKICAKICByZXR1cm4gT2JqZWN0LmVudHJpZXMo\nY3VzdG9tZXJDb3VudHMpCiAgICAuc29ydCgoWyxhXSwgWyxiXSkgPT4gYiAt\nIGEpCiAgICAuc2xpY2UoMCwgNSkKICAgIC5tYXAoKFtlbWFpbCwgY291bnRd\nKSA9PiAoeyBlbWFpbCwgdGlja2V0Q291bnQ6IGNvdW50IH0pKTsKfQoKLy8g\nU3RhcnQgc2VydmVyCmFwcC5saXN0ZW4ocG9ydCwgKCkgPT4gewogIGNvbnNv\nbGUubG9nKGBPQXV0aCBiYWNrZW5kIHdpdGggY3VzdG9tZXIgc3VwcG9ydCBy\ndW5uaW5nIG9uIHBvcnQgJHtwb3J0fWApOwogIGNvbnNvbGUubG9nKGBWZXJz\naW9uOiA2LjAuMC1jdXN0b21lci1zdXBwb3J0YCk7CiAgY29uc29sZS5sb2co\nYEZlYXR1cmVzOiBPQXV0aCwgUHJvZHVjdHMsIE1lZGlhIFVwbG9hZCwgUHJp\nY2luZywgQ3VzdG9tZXIgU3VwcG9ydGApOwogIGNvbnNvbGUubG9nKGBJbnN0\nYWxsYXRpb25zOiAke2luc3RhbGxhdGlvbnMuc2l6ZX1gKTsKICBjb25zb2xl\nLmxvZygnQ3VzdG9tZXIgc3VwcG9ydCBzeXN0ZW06IFJlYWR5Jyk7Cn0pOwo=\n",
  "encoding": "base64",
  "_links": {
    "self": "https://api.github.com/repos/EngageAutomations/oauth-backend/contents/index.js?ref=main",
    "git": "https://api.github.com/repos/EngageAutomations/oauth-backend/git/blobs/146d989c9a51f4e4c37a2f52aa1a2b31208a3d29",
    "html": "https://github.com/EngageAutomations/oauth-backend/blob/main/index.js"
  }
}
