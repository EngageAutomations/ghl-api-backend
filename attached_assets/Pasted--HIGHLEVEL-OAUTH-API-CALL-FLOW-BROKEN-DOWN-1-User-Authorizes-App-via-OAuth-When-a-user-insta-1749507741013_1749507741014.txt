ğŸ”§ HIGHLEVEL OAUTH API CALL FLOW â€” BROKEN DOWN
1. ğŸ” User Authorizes App via OAuth
When a user installs your app from the Marketplace:

HighLevel sends them to:

arduino
Copy
Edit
https://api.leadconnectorhq.com/oauth/authorize
  ?response_type=code
  &client_id=YOUR_CLIENT_ID
  &redirect_uri=YOUR_REDIRECT_URI
  &scope=contacts.read contacts.write ...
  &state=SOME_TOKEN
The user logs in and clicks â€œAuthorizeâ€.

2. ğŸ“¥ You Receive Authorization Code
HighLevel redirects the user to your app:

perl
Copy
Edit
https://your-app.com/oauth/callback?code=ABC123&state=TOKEN
This code is short-lived and must be exchanged immediately.

3. ğŸ”‘ Exchange Code for Access + Refresh Token
You make a server-side POST request:

http
Copy
Edit
POST https://services.leadconnectorhq.com/oauth/token
Content-Type: application/x-www-form-urlencoded

client_id=YOUR_CLIENT_ID
&client_secret=YOUR_CLIENT_SECRET
&grant_type=authorization_code
&code=ABC123
&redirect_uri=YOUR_REDIRECT_URI
âœ… You get back:
json
Copy
Edit
{
  "access_token": "xyz123",
  "refresh_token": "abc456",
  "expires_in": 3600,
  "locationId": "LOC_ID",
  "userId": "USER_ID"
}
4. ğŸ” Make Authenticated API Calls
Use the access_token in the Authorization header for all API requests:

http
Copy
Edit
GET https://services.leadconnectorhq.com/products/
Authorization: Bearer xyz123
Use locationId in the body or query params when required.

5. ğŸ” Refresh Expired Token
When your access_token expires:

http
Copy
Edit
POST https://services.leadconnectorhq.com/oauth/token
Content-Type: application/x-www-form-urlencoded

client_id=YOUR_CLIENT_ID
&client_secret=YOUR_CLIENT_SECRET
&grant_type=refresh_token
&refresh_token=abc456
â†’ You get a new access_token and optionally a new refresh_token.

ğŸ” TOKEN HANDLING FLOW DIAGRAM (TEXTUAL)
csharp
Copy
Edit
[User Clicks Install] 
     â†“
[OAuth Redirect to HighLevel]
     â†“
[User Authorizes]
     â†“
[HighLevel Redirects Back with `code`]
     â†“
[Your Server: Exchange `code` â†’ `access_token` + `refresh_token`]
     â†“
[Store tokens + locationId]
     â†“
[Make Authenticated API Calls using `access_token`]
     â†“
[Refresh Token as Needed]
âš ï¸ DONâ€™T DO:
âŒ Donâ€™t try to grab their API key

âŒ Donâ€™t expose tokens in frontend

âŒ Donâ€™t store tokens insecurely

âœ… DO:
âœ… Securely store access_token, refresh_token, and locationId in a database

âœ… Use Bearer access_token in all authenticated API calls

âœ… Track token expiry and refresh as needed

